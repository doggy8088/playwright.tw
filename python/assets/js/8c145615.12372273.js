"use strict";(self.webpackChunkplaywright_dev=self.webpackChunkplaywright_dev||[]).push([[3568],{1740:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>c,toc:()=>o});var r=n(4848),t=n(8453);n(4235),n(8328),n(3078);const i={id:"test-runners",title:"Pytest \u5916\u639b\u53c3\u8003"},l=void 0,c={id:"test-runners",title:"Pytest \u5916\u639b\u53c3\u8003",description:"\u7c21\u4ecb",source:"@site/versioned_docs/version-stable/test-runners.mdx",sourceDirName:".",slug:"/test-runners",permalink:"/python/docs/test-runners",draft:!1,unlisted:!1,tags:[],version:"stable",frontMatter:{id:"test-runners",title:"Pytest \u5916\u639b\u53c3\u8003"},sidebar:"docs",previous:{title:"\u8a2d\u5b9a CI",permalink:"/python/docs/ci-intro"},next:{title:"\u958b\u59cb\u4f7f\u7528 - \u51fd\u5f0f\u5eab",permalink:"/python/docs/library"}},d={},o=[{value:"\u7c21\u4ecb",id:"\u7c21\u4ecb",level:2},{value:"\u4f7f\u7528\u65b9\u5f0f",id:"\u4f7f\u7528\u65b9\u5f0f",level:2},{value:"CLI arguments",id:"cli-arguments",level:2},{value:"Fixtures",id:"fixtures",level:2},{value:"\u5e73\u884c\u8655\u7406: \u540c\u6642\u57f7\u884c\u591a\u500b\u6e2c\u8a66",id:"\u5e73\u884c\u8655\u7406-\u540c\u6642\u57f7\u884c\u591a\u500b\u6e2c\u8a66",level:2},{value:"\u7bc4\u4f8b",id:"\u7bc4\u4f8b",level:2},{value:"\u8a2d\u5b9a Mypy typings \u4ee5\u81ea\u52d5\u5b8c\u6210",id:"\u8a2d\u5b9a-mypy-typings-\u4ee5\u81ea\u52d5\u5b8c\u6210",level:3},{value:"\u8a2d\u5b9a slow mo",id:"\u8a2d\u5b9a-slow-mo",level:3},{value:"\u8df3\u904e\u700f\u89bd\u5668\u6e2c\u8a66",id:"\u8df3\u904e\u700f\u89bd\u5668\u6e2c\u8a66",level:3},{value:"\u5728\u7279\u5b9a\u700f\u89bd\u5668\u4e0a\u57f7\u884c",id:"\u5728\u7279\u5b9a\u700f\u89bd\u5668\u4e0a\u57f7\u884c",level:3},{value:"\u4f7f\u7528\u81ea\u8a02\u700f\u89bd\u5668\u901a\u9053\u57f7\u884c\uff0c\u4f8b\u5982 Google Chrome \u6216 Microsoft Edge",id:"\u4f7f\u7528\u81ea\u8a02\u700f\u89bd\u5668\u901a\u9053\u57f7\u884c\u4f8b\u5982-google-chrome-\u6216-microsoft-edge",level:3},{value:"\u8a2d\u5b9a base-url",id:"\u8a2d\u5b9a-base-url",level:3},{value:"\u5ffd\u7565 HTTPS \u932f\u8aa4",id:"\u5ffd\u7565-https-\u932f\u8aa4",level:3},{value:"\u4f7f\u7528\u81ea\u8a02\u8996\u7a97\u5927\u5c0f",id:"\u4f7f\u7528\u81ea\u8a02\u8996\u7a97\u5927\u5c0f",level:3},{value:"\u88dd\u7f6e\u6a21\u64ec",id:"\u88dd\u7f6e\u6a21\u64ec",level:3},{value:"\u4f7f\u7528\u8207 <code>unittest.TestCase</code>",id:"\u4f7f\u7528\u8207-unittesttestcase",level:3},{value:"\u9664\u932f",id:"\u9664\u932f",level:2},{value:"\u8207 pdb \u4e00\u8d77\u4f7f\u7528",id:"\u8207-pdb-\u4e00\u8d77\u4f7f\u7528",level:3},{value:"\u90e8\u7f72\u5230 CI",id:"\u90e8\u7f72\u5230-ci",level:2}];function a(e){const s={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.h2,{id:"\u7c21\u4ecb",children:"\u7c21\u4ecb"}),"\n",(0,r.jsxs)(s.p,{children:["Playwright \u63d0\u4f9b\u4e00\u500b ",(0,r.jsx)(s.a,{href:"https://docs.pytest.org/en/stable/",children:"Pytest"})," \u5916\u639b\u4f86\u7de8\u5beb\u7aef\u5230\u7aef\u6e2c\u8a66\u3002\u8981\u958b\u59cb\u4f7f\u7528\u5b83\uff0c\u8acb\u53c3\u8003 ",(0,r.jsx)(s.a,{href:"/python/docs/intro",children:"getting started guide"}),"\u3002"]}),"\n",(0,r.jsx)(s.h2,{id:"\u4f7f\u7528\u65b9\u5f0f",children:"\u4f7f\u7528\u65b9\u5f0f"}),"\n",(0,r.jsxs)(s.p,{children:["\u8981\u57f7\u884c\u4f60\u7684\u6e2c\u8a66\uff0c\u4f7f\u7528 ",(0,r.jsx)(s.a,{href:"https://docs.pytest.org/en/stable/",children:"Pytest"})," CLI\u3002"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"pytest --browser webkit --headed\n"})}),"\n",(0,r.jsxs)(s.p,{children:["\u5982\u679c\u4f60\u60f3\u81ea\u52d5\u6dfb\u52a0 CLI \u53c3\u6578\u800c\u4e0d\u6307\u5b9a\u5b83\u5011\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 ",(0,r.jsx)(s.a,{href:"https://docs.pytest.org/en/stable/reference.html#ini-options-ref",children:"pytest.ini"})," \u6587\u4ef6:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ini",children:"# content of pytest.ini\n[pytest]\n# Run firefox with UI\naddopts = --headed --browser firefox\n"})}),"\n",(0,r.jsx)(s.h2,{id:"cli-arguments",children:"CLI arguments"}),"\n",(0,r.jsxs)(s.p,{children:["\u6ce8\u610f\uff0cCLI \u53c3\u6578\u50c5\u9069\u7528\u65bc\u9810\u8a2d\u7684 ",(0,r.jsx)(s.code,{children:"browser"}),"\u3001",(0,r.jsx)(s.code,{children:"context"})," \u548c ",(0,r.jsx)(s.code,{children:"page"})," \u56fa\u5b9a\u88dd\u7f6e\u3002\u5982\u679c\u4f60\u4f7f\u7528 API \u547c\u53eb\u5efa\u7acb\u4e00\u500b browser\u3001context \u6216 page\uff0c\u4f8b\u5982 ",(0,r.jsx)(s.a,{href:"/python/docs/api/class-browser#browser-new-context",children:"browser.new_context()"}),"\uff0cCLI \u53c3\u6578\u5c07\u4e0d\u6703\u88ab\u61c9\u7528\u3002"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"--headed"}),": \u5728 headed \u6a21\u5f0f\u4e0b\u57f7\u884c\u6e2c\u8a66 (\u9810\u8a2d: headless)\u3002"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"--browser"}),": \u5728\u4e0d\u540c\u7684\u700f\u89bd\u5668 ",(0,r.jsx)(s.code,{children:"chromium"}),"\u3001",(0,r.jsx)(s.code,{children:"firefox"})," \u6216 ",(0,r.jsx)(s.code,{children:"webkit"})," \u4e2d\u57f7\u884c\u6e2c\u8a66\u3002\u53ef\u4ee5\u591a\u6b21\u6307\u5b9a (\u9810\u8a2d: ",(0,r.jsx)(s.code,{children:"chromium"}),")\u3002"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"--browser-channel"})," \u8981\u4f7f\u7528\u7684 ",(0,r.jsx)(s.a,{href:"/python/docs/browsers",children:"Browser channel"}),"\u3002"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"--slowmo"})," \u5c07 Playwright \u64cd\u4f5c\u6e1b\u6162\u6307\u5b9a\u7684\u6beb\u79d2\u6578\u3002\u9019\u6a23\u53ef\u4ee5\u770b\u5230\u767c\u751f\u4e86\u4ec0\u9ebc (\u9810\u8a2d: 0)\u3002"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"--device"})," \u8981\u6a21\u64ec\u7684 ",(0,r.jsx)(s.a,{href:"/python/docs/emulation",children:"Device"}),"\u3002"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"--output"})," \u6e2c\u8a66\u7522\u751f\u7684\u5de5\u4ef6\u76ee\u9304 (\u9810\u8a2d: ",(0,r.jsx)(s.code,{children:"test-results"}),")\u3002"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"--tracing"})," \u662f\u5426\u70ba\u6bcf\u500b\u6e2c\u8a66\u8a18\u9304 ",(0,r.jsx)(s.a,{href:"/python/docs/trace-viewer",children:"trace"}),"\u3002",(0,r.jsx)(s.code,{children:"on"}),"\u3001",(0,r.jsx)(s.code,{children:"off"})," \u6216 ",(0,r.jsx)(s.code,{children:"retain-on-failure"})," (\u9810\u8a2d: ",(0,r.jsx)(s.code,{children:"off"}),")\u3002"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"--video"})," \u662f\u5426\u70ba\u6bcf\u500b\u6e2c\u8a66\u9304\u88fd\u5f71\u7247\u3002",(0,r.jsx)(s.code,{children:"on"}),"\u3001",(0,r.jsx)(s.code,{children:"off"})," \u6216 ",(0,r.jsx)(s.code,{children:"retain-on-failure"})," (\u9810\u8a2d: ",(0,r.jsx)(s.code,{children:"off"}),")\u3002"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"--screenshot"})," \u662f\u5426\u5728\u6bcf\u6b21\u6e2c\u8a66\u5f8c\u81ea\u52d5\u622a\u53d6\u87a2\u5e55\u622a\u5716\u3002",(0,r.jsx)(s.code,{children:"on"}),"\u3001",(0,r.jsx)(s.code,{children:"off"})," \u6216 ",(0,r.jsx)(s.code,{children:"only-on-failure"})," (\u9810\u8a2d: ",(0,r.jsx)(s.code,{children:"off"}),")\u3002"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"--full-page-screenshot"})," \u662f\u5426\u5728\u5931\u6557\u6642\u622a\u53d6\u6574\u9801\u622a\u5716\u3002\u9810\u8a2d\u60c5\u6cc1\u4e0b\uff0c\u50c5\u6355\u7372\u8996\u53e3\u3002\u9700\u8981\u555f\u7528 ",(0,r.jsx)(s.code,{children:"--screenshot"})," (\u9810\u8a2d: ",(0,r.jsx)(s.code,{children:"off"}),")\u3002"]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"fixtures",children:"Fixtures"}),"\n",(0,r.jsxs)(s.p,{children:["\u6b64\u5916\u639b\u914d\u7f6e\u4e86 Playwright \u7279\u5b9a\u7684 ",(0,r.jsx)(s.a,{href:"https://docs.pytest.org/en/latest/fixture.html",children:"pytest \u593e\u5177"}),"\u3002\u8981\u4f7f\u7528\u9019\u4e9b\u593e\u5177\uff0c\u8acb\u5c07\u593e\u5177\u540d\u7a31\u4f5c\u70ba\u6e2c\u8a66\u51fd\u5f0f\u7684\u53c3\u6578\u3002"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-py",children:"def test_my_app_is_working(fixture_name):\n    pass\n    # Test using fixture_name\n    # ...\n"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"\u51fd\u5f0f\u7bc4\u570d"}),": \u9019\u4e9b\u56fa\u5b9a\u88dd\u7f6e\u5728\u6e2c\u8a66\u51fd\u5f0f\u4e2d\u8acb\u6c42\u6642\u5efa\u7acb\uff0c\u4e26\u5728\u6e2c\u8a66\u7d50\u675f\u6642\u92b7\u6bc0\u3002"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"context"}),": \u65b0\u7684 ",(0,r.jsx)(s.a,{href:"./browser-contexts",children:"browser context"})," \u7528\u65bc\u6e2c\u8a66\u3002"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"page"}),": \u65b0\u7684 ",(0,r.jsx)(s.a,{href:"./pages",children:"browser page"})," \u7528\u65bc\u6e2c\u8a66\u3002"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"new_context"}),": \u5141\u8a31\u5efa\u7acb\u4e0d\u540c\u7684 ",(0,r.jsx)(s.a,{href:"./browser-contexts",children:"browser contexts"})," \u7528\u65bc\u6e2c\u8a66\u3002\u5c0d\u65bc\u591a\u4f7f\u7528\u8005\u5834\u666f\u5f88\u6709\u7528\u3002\u63a5\u53d7\u8207 ",(0,r.jsx)(s.a,{href:"/python/docs/api/class-browser#browser-new-context",children:"browser.new_context()"})," \u76f8\u540c\u7684\u53c3\u6578\u3002"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Session scope"}),": \u9019\u4e9b \u7269\u4ef6 \u5728\u6e2c\u8a66 \u51fd\u5f0f \u4e2d\u8acb\u6c42\u6642 \u5efa\u7acb\uff0c\u4e26\u5728\u6240\u6709\u6e2c\u8a66\u7d50\u675f\u6642\u92b7\u6bc0\u3002"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"playwright"}),": ",(0,r.jsx)(s.a,{href:"./api/class-playwright",children:"Playwright"})," \u5be6\u4f8b."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"browser_type"}),": ",(0,r.jsx)(s.a,{href:"./api/class-browsertype",children:"BrowserType"})," \u7576\u524d\u700f\u89bd\u5668\u7684\u5be6\u4f8b."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"browser"}),": ",(0,r.jsx)(s.a,{href:"./api/class-browser",children:"Browser"})," \u7531 Playwright \u555f\u52d5\u7684\u5be6\u4f8b."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"browser_name"}),": \u700f\u89bd\u5668\u540d\u7a31\u4f5c\u70ba\u5b57\u4e32."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"browser_channel"}),": \u700f\u89bd\u5668\u983b\u9053\u4f5c\u70ba\u5b57\u4e32."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"is_chromium"}),", ",(0,r.jsx)(s.code,{children:"is_webkit"}),", ",(0,r.jsx)(s.code,{children:"is_firefox"}),": \u5206\u5225\u5c0d\u61c9\u700f\u89bd\u5668\u985e\u578b\u7684\u5e03\u6797\u503c."]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"\u81ea\u8a02 fixture \u9078\u9805"}),": \u5c0d\u65bc ",(0,r.jsx)(s.code,{children:"browser"})," \u548c ",(0,r.jsx)(s.code,{children:"context"})," fixtures\uff0c\u4f7f\u7528\u4ee5\u4e0b fixtures \u5b9a\u7fa9\u81ea\u8a02\u555f\u52d5\u9078\u9805\u3002"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"browser_type_launch_args"}),": \u8986\u5beb ",(0,r.jsx)(s.a,{href:"/python/docs/api/class-browsertype#browser-type-launch",children:"browser_type.launch()"})," \u7684\u555f\u52d5\u53c3\u6578\u3002\u5b83\u61c9\u8a72\u8fd4\u56de\u4e00\u500b Dict\u3002"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"browser_context_args"}),": \u8986\u5beb ",(0,r.jsx)(s.a,{href:"/python/docs/api/class-browser#browser-new-context",children:"browser.new_context()"})," \u7684\u9078\u9805\u3002\u5b83\u61c9\u8a72\u8fd4\u56de\u4e00\u500b Dict\u3002"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["\u4e5f\u53ef\u4ee5\u4f7f\u7528 ",(0,r.jsx)(s.code,{children:"browser_context_args"})," \u6a19\u8a18\u4f86\u8986\u84cb\u55ae\u500b\u6e2c\u8a66\u7684\u4e0a\u4e0b\u6587\u9078\u9805(",(0,r.jsx)(s.a,{href:"/python/docs/api/class-browser#browser-new-context",children:"browser.new_context()"}),")\u3002"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",children:'import pytest\n\n@pytest.mark.browser_context_args(timezone_id="Europe/Berlin", locale="en-GB")\ndef test_browser_context_args(page):\n    assert page.evaluate("window.navigator.userAgent") == "Europe/Berlin"\n    assert page.evaluate("window.navigator.languages") == ["de-DE"]\n'})}),"\n",(0,r.jsx)(s.h2,{id:"\u5e73\u884c\u8655\u7406-\u540c\u6642\u57f7\u884c\u591a\u500b\u6e2c\u8a66",children:"\u5e73\u884c\u8655\u7406: \u540c\u6642\u57f7\u884c\u591a\u500b\u6e2c\u8a66"}),"\n",(0,r.jsxs)(s.p,{children:["\u5982\u679c\u4f60\u7684\u6e2c\u8a66\u5728\u4e00\u53f0\u6709\u5f88\u591a CPU \u7684\u6a5f\u5668\u4e0a\u57f7\u884c\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 ",(0,r.jsx)(s.a,{href:"https://pypi.org/project/pytest-xdist/",children:(0,r.jsx)(s.code,{children:"pytest-xdist"})})," \u540c\u6642\u57f7\u884c\u591a\u500b\u6e2c\u8a66\u4f86\u52a0\u5feb\u6574\u9ad4\u6e2c\u8a66\u5957\u4ef6\u7684\u57f7\u884c\u6642\u9593:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"# install dependency\npip install pytest-xdist\n# use the --numprocesses flag\npytest --numprocesses auto\n"})}),"\n",(0,r.jsxs)(s.p,{children:["\u6839\u64da\u786c\u9ad4\u548c\u6e2c\u8a66\u7684\u6027\u8cea\uff0c\u4f60\u53ef\u4ee5\u5c07 ",(0,r.jsx)(s.code,{children:"numprocesses"})," \u8a2d\u5b9a\u70ba\u5f9e ",(0,r.jsx)(s.code,{children:"2"})," \u5230\u6a5f\u5668\u4e0a\u7684 CPU \u6578\u91cf\u3002\u5982\u679c\u8a2d\u7f6e\u904e\u9ad8\uff0c\u4f60\u53ef\u80fd\u6703\u6ce8\u610f\u5230\u610f\u5916\u7684\u884c\u70ba\u3002"]}),"\n",(0,r.jsxs)(s.p,{children:["\u8acb\u53c3\u95b1 ",(0,r.jsx)(s.a,{href:"/python/docs/running-tests",children:"\u57f7\u884c\u6e2c\u8a66"})," \u4ee5\u7372\u53d6\u6709\u95dc ",(0,r.jsx)(s.code,{children:"pytest"})," \u9078\u9805\u7684\u4e00\u822c\u8cc7\u8a0a\u3002"]}),"\n",(0,r.jsx)(s.h2,{id:"\u7bc4\u4f8b",children:"\u7bc4\u4f8b"}),"\n",(0,r.jsx)(s.h3,{id:"\u8a2d\u5b9a-mypy-typings-\u4ee5\u81ea\u52d5\u5b8c\u6210",children:"\u8a2d\u5b9a Mypy typings \u4ee5\u81ea\u52d5\u5b8c\u6210"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-py",metastring:'title="test_my_application.py"',children:'from playwright.sync_api import Page\n\ndef test_visit_admin_dashboard(page: Page):\n    page.goto("/admin")\n    # ...\n'})}),"\n",(0,r.jsx)(s.h3,{id:"\u8a2d\u5b9a-slow-mo",children:"\u8a2d\u5b9a slow mo"}),"\n",(0,r.jsxs)(s.p,{children:["\u4f7f\u7528 ",(0,r.jsx)(s.code,{children:"--slowmo"})," \u53c3\u6578\u6162\u901f\u57f7\u884c\u6e2c\u8a66\u3002"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"pytest --slowmo 100\n"})}),"\n",(0,r.jsx)(s.p,{children:"\u5c07 Playwright \u64cd\u4f5c\u6e1b\u6162 100 \u6beb\u79d2\u3002"}),"\n",(0,r.jsx)(s.h3,{id:"\u8df3\u904e\u700f\u89bd\u5668\u6e2c\u8a66",children:"\u8df3\u904e\u700f\u89bd\u5668\u6e2c\u8a66"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-py",metastring:'title="test_my_application.py"',children:'import pytest\n\n@pytest.mark.skip_browser("firefox")\ndef test_visit_example(page):\n    page.goto("https://example.com")\n    # ...\n'})}),"\n",(0,r.jsx)(s.h3,{id:"\u5728\u7279\u5b9a\u700f\u89bd\u5668\u4e0a\u57f7\u884c",children:"\u5728\u7279\u5b9a\u700f\u89bd\u5668\u4e0a\u57f7\u884c"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-py",metastring:'title="conftest.py"',children:'import pytest\n\n@pytest.mark.only_browser("chromium")\ndef test_visit_example(page):\n    page.goto("https://example.com")\n    # ...\n'})}),"\n",(0,r.jsx)(s.h3,{id:"\u4f7f\u7528\u81ea\u8a02\u700f\u89bd\u5668\u901a\u9053\u57f7\u884c\u4f8b\u5982-google-chrome-\u6216-microsoft-edge",children:"\u4f7f\u7528\u81ea\u8a02\u700f\u89bd\u5668\u901a\u9053\u57f7\u884c\uff0c\u4f8b\u5982 Google Chrome \u6216 Microsoft Edge"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"pytest --browser-channel chrome\n"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-python",metastring:'title="test_my_application.py"',children:'def test_example(page):\n    page.goto("https://example.com")\n'})}),"\n",(0,r.jsx)(s.h3,{id:"\u8a2d\u5b9a-base-url",children:"\u8a2d\u5b9a base-url"}),"\n",(0,r.jsxs)(s.p,{children:["\u958b\u59cb Pytest \u4e26\u4f7f\u7528 ",(0,r.jsx)(s.code,{children:"base-url"})," \u53c3\u6578\u3002",(0,r.jsx)(s.a,{href:"https://github.com/pytest-dev/pytest-base-url",children:(0,r.jsx)(s.code,{children:"pytest-base-url"})})," \u5916\u639b\u7528\u65bc\u6b64\uff0c\u5141\u8a31\u60a8\u5f9e\u914d\u7f6e\u3001CLI \u53c3\u6578\u6216\u4f5c\u70ba\u56fa\u5b9a\u88dd\u7f6e\u8a2d\u5b9a\u57fa\u790e url\u3002"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"pytest --base-url http://localhost:8080\n"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-py",metastring:'title="test_my_application.py"',children:'def test_visit_example(page):\n    page.goto("/admin")\n    # -> Will result in http://localhost:8080/admin\n'})}),"\n",(0,r.jsx)(s.h3,{id:"\u5ffd\u7565-https-\u932f\u8aa4",children:"\u5ffd\u7565 HTTPS \u932f\u8aa4"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-py",metastring:'title="conftest.py"',children:'import pytest\n\n@pytest.fixture(scope="session")\ndef browser_context_args(browser_context_args):\n    return {\n        **browser_context_args,\n        "ignore_https_errors": True\n    }\n'})}),"\n",(0,r.jsx)(s.h3,{id:"\u4f7f\u7528\u81ea\u8a02\u8996\u7a97\u5927\u5c0f",children:"\u4f7f\u7528\u81ea\u8a02\u8996\u7a97\u5927\u5c0f"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-py",metastring:'title="conftest.py"',children:'import pytest\n\n@pytest.fixture(scope="session")\ndef browser_context_args(browser_context_args):\n    return {\n        **browser_context_args,\n        "viewport": {\n            "width": 1920,\n            "height": 1080,\n        }\n    }\n'})}),"\n",(0,r.jsx)(s.h3,{id:"\u88dd\u7f6e\u6a21\u64ec",children:"\u88dd\u7f6e\u6a21\u64ec"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-py",metastring:'title="conftest.py"',children:"import pytest\n\n@pytest.fixture(scope=\"session\")\ndef browser_context_args(browser_context_args, playwright):\n    iphone_11 = playwright.devices['iPhone 11 Pro']\n    return {\n        **browser_context_args,\n        **iphone_11,\n    }\n"})}),"\n",(0,r.jsxs)(s.p,{children:["\u6216\u8005\u901a\u904e CLI ",(0,r.jsx)(s.code,{children:'--device="iPhone 11 Pro"'})]}),"\n",(0,r.jsxs)(s.h3,{id:"\u4f7f\u7528\u8207-unittesttestcase",children:["\u4f7f\u7528\u8207 ",(0,r.jsx)(s.code,{children:"unittest.TestCase"})]}),"\n",(0,r.jsxs)(s.p,{children:["\u8acb\u53c3\u95b1\u4ee5\u4e0b\u7bc4\u4f8b\uff0c\u4ee5\u4e86\u89e3\u5982\u4f55\u5c07\u5176\u8207 ",(0,r.jsx)(s.code,{children:"unittest.TestCase"})," \u4e00\u8d77\u4f7f\u7528\u3002\u9019\u6709\u4e00\u500b\u9650\u5236\uff0c\u5373\u53ea\u80fd\u6307\u5b9a\u55ae\u4e00\u700f\u89bd\u5668\uff0c\u4e26\u4e14\u5728\u6307\u5b9a\u591a\u500b\u700f\u89bd\u5668\u6642\u4e0d\u6703\u751f\u6210\u591a\u500b\u700f\u89bd\u5668\u7684\u77e9\u9663\u3002"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-py",children:'import pytest\nimport unittest\n\nfrom playwright.sync_api import Page\n\n\nclass MyTest(unittest.TestCase):\n    @pytest.fixture(autouse=True)\n    def setup(self, page: Page):\n        self.page = page\n\n    def test_foobar(self):\n        self.page.goto("https://microsoft.com")\n        self.page.locator("#foobar").click()\n        assert self.page.evaluate("1 + 1") == 2\n'})}),"\n",(0,r.jsx)(s.h2,{id:"\u9664\u932f",children:"\u9664\u932f"}),"\n",(0,r.jsx)(s.h3,{id:"\u8207-pdb-\u4e00\u8d77\u4f7f\u7528",children:"\u8207 pdb \u4e00\u8d77\u4f7f\u7528"}),"\n",(0,r.jsxs)(s.p,{children:["\u5728\u60a8\u7684\u6e2c\u8a66\u7a0b\u5f0f\u78bc\u4e2d\u4f7f\u7528 ",(0,r.jsx)(s.code,{children:"breakpoint()"})," \u8a9e\u53e5\u4f86\u66ab\u505c\u57f7\u884c\u4e26\u7372\u53d6 ",(0,r.jsx)(s.a,{href:"https://docs.python.org/3/library/pdb.html",children:"pdb"})," REPL\u3002"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-py",children:'def test_bing_is_working(page):\n    page.goto("https://bing.com")\n    breakpoint()\n    # ...\n'})}),"\n",(0,r.jsx)(s.h2,{id:"\u90e8\u7f72\u5230-ci",children:"\u90e8\u7f72\u5230 CI"}),"\n",(0,r.jsxs)(s.p,{children:["\u8acb\u53c3\u95b1",(0,r.jsx)(s.a,{href:"/python/docs/ci",children:"CI \u63d0\u4f9b\u8005\u6307\u5357"}),"\u4ee5\u90e8\u7f72\u60a8\u7684\u6e2c\u8a66\u5230 CI/CD\u3002"]})]})}function h(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);