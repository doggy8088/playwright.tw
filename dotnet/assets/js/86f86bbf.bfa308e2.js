"use strict";(self.webpackChunkplaywright_dev=self.webpackChunkplaywright_dev||[]).push([[6983],{8960:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>r,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>d});var a=i(4848),o=i(8453);i(4235),i(8328),i(3078);const t={id:"dialogs",title:"Dialogs"},l=void 0,s={id:"dialogs",title:"Dialogs",description:"Introduction",source:"@site/docs/dialogs.mdx",sourceDirName:".",slug:"/dialogs",permalink:"/dotnet/docs/next/dialogs",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"dialogs",title:"Dialogs"},sidebar:"docs",previous:{title:"Debugging Tests",permalink:"/dotnet/docs/next/debug"},next:{title:"Downloads",permalink:"/dotnet/docs/next/downloads"}},r={},d=[{value:"Introduction",id:"introduction",level:2},{value:"alert(), confirm(), prompt() dialogs",id:"alert-confirm-prompt-dialogs",level:2},{value:"beforeunload dialog",id:"beforeunload-dialog",level:2},{value:"Print dialogs",id:"print-dialogs",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,a.jsxs)(n.p,{children:["Playwright can interact with the web page dialogs such as ",(0,a.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/Window/alert",children:(0,a.jsx)(n.code,{children:"alert"})}),", ",(0,a.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/Window/confirm",children:(0,a.jsx)(n.code,{children:"confirm"})}),", ",(0,a.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/Window/prompt",children:(0,a.jsx)(n.code,{children:"prompt"})})," as well as ",(0,a.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/Window/beforeunload_event",children:(0,a.jsx)(n.code,{children:"beforeunload"})})," confirmation. For print dialogs, see ",(0,a.jsx)(n.a,{href:"#print-dialogs",children:"Print"}),"."]}),"\n",(0,a.jsx)(n.h2,{id:"alert-confirm-prompt-dialogs",children:"alert(), confirm(), prompt() dialogs"}),"\n",(0,a.jsxs)(n.p,{children:["By default, dialogs are auto-dismissed by Playwright, so you don't have to handle them. However, you can register a dialog handler before the action that triggers the dialog to either ",(0,a.jsx)(n.a,{href:"/dotnet/docs/next/api/class-dialog#dialog-accept",children:"Dialog.AcceptAsync()"})," or ",(0,a.jsx)(n.a,{href:"/dotnet/docs/next/api/class-dialog#dialog-dismiss",children:"Dialog.DismissAsync()"})," it."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:"Page.Dialog += async (_, dialog) =>\n{\n    await dialog.AcceptAsync();\n};\nawait Page.GetByRole(AriaRole.Button).ClickAsync();\n"})}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.a,{href:"/dotnet/docs/next/api/class-page#page-event-dialog",children:"Page.Dialog"})," listener ",(0,a.jsx)(n.strong,{children:"must handle"})," the dialog. Otherwise your action will stall, be it ",(0,a.jsx)(n.a,{href:"/dotnet/docs/next/api/class-locator#locator-click",children:"Locator.ClickAsync()"})," or something else. That's because dialogs in Web are modals and therefore block further page execution until they are handled."]})}),"\n",(0,a.jsx)(n.p,{children:"As a result, the following snippet will never resolve:"}),"\n",(0,a.jsx)(n.admonition,{type:"warning",children:(0,a.jsx)(n.p,{children:"WRONG!"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:"page.Dialog += (_, dialog) => Console.WriteLine(dialog.Message);\nawait page.GetByRole(AriaRole.Button).ClickAsync(); // Will hang here\n"})}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsxs)(n.p,{children:["If there is no listener for ",(0,a.jsx)(n.a,{href:"/dotnet/docs/next/api/class-page#page-event-dialog",children:"Page.Dialog"}),", all dialogs are automatically dismissed."]})}),"\n",(0,a.jsx)(n.h2,{id:"beforeunload-dialog",children:"beforeunload dialog"}),"\n",(0,a.jsxs)(n.p,{children:["When ",(0,a.jsx)(n.a,{href:"/dotnet/docs/next/api/class-page#page-close",children:"Page.CloseAsync()"})," is invoked with the truthy ",(0,a.jsx)(n.code,{children:"runBeforeUnload"})," value, the page runs its unload handlers. This is the only case when ",(0,a.jsx)(n.a,{href:"/dotnet/docs/next/api/class-page#page-close",children:"Page.CloseAsync()"})," does not wait for the page to actually close, because it might be that the page stays open in the end of the operation."]}),"\n",(0,a.jsxs)(n.p,{children:["You can register a dialog handler to handle the ",(0,a.jsx)(n.code,{children:"beforeunload"})," dialog yourself:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'Page.Dialog += async (_, dialog) =>\n{\n    Assert.AreEqual("beforeunload", dialog.Type);\n    await dialog.DismissAsync();\n};\nawait Page.CloseAsync(new() { RunBeforeUnload = true });\n'})}),"\n",(0,a.jsx)(n.h2,{id:"print-dialogs",children:"Print dialogs"}),"\n",(0,a.jsxs)(n.p,{children:["In order to assert that a print dialog via ",(0,a.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/Window/print",children:(0,a.jsx)(n.code,{children:"window.print"})})," was triggered, you can use the following snippet:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'await Page.GotoAsync("<url>");\n\nawait Page.EvaluateAsync("(() => {window.waitForPrintDialog = new Promise(f => window.print = f);})()");\nawait Page.GetByText("Print it!").ClickAsync();\n\nawait Page.WaitForFunctionAsync("window.waitForPrintDialog");\n'})}),"\n",(0,a.jsx)(n.p,{children:"This will wait for the print dialog to be opened after the button is clicked. Make sure to evaluate the script before clicking the button / after the page is loaded."})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}}}]);