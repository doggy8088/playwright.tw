"use strict";(self.webpackChunkplaywright_dev=self.webpackChunkplaywright_dev||[]).push([[2518],{8962:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>m,frontMatter:()=>l,metadata:()=>o,toc:()=>d});var a=n(4848),c=n(8453),i=(n(4235),n(8328),n(3078),n(4562));const l={id:"clock",title:"\u6642\u9418"},r=void 0,o={id:"clock",title:"\u6642\u9418",description:"\u7c21\u4ecb",source:"@site/versioned_docs/version-stable/clock.mdx",sourceDirName:".",slug:"/clock",permalink:"/dotnet/docs/clock",draft:!1,unlisted:!1,tags:[],version:"stable",frontMatter:{id:"clock",title:"\u6642\u9418"},sidebar:"docs",previous:{title:"\u700f\u89bd\u5668",permalink:"/dotnet/docs/browsers"},next:{title:"\u5075\u932f\u6e2c\u8a66",permalink:"/dotnet/docs/debug"}},s={},d=[{value:"\u7c21\u4ecb",id:"\u7c21\u4ecb",level:2},{value:"\u6e2c\u8a66\u9810\u5b9a\u6642\u9593",id:"\u6e2c\u8a66\u9810\u5b9a\u6642\u9593",level:2},{value:"\u4e00\u81f4\u7684\u6642\u9593\u548c\u8a08\u6642\u5668",id:"\u4e00\u81f4\u7684\u6642\u9593\u548c\u8a08\u6642\u5668",level:2},{value:"\u6e2c\u8a66\u975e\u6d3b\u52d5\u76e3\u63a7",id:"\u6e2c\u8a66\u975e\u6d3b\u52d5\u76e3\u63a7",level:2},{value:"\u624b\u52d5\u8a08\u6642\uff0c\u6301\u7e8c\u89f8\u767c\u6240\u6709\u8a08\u6642\u5668",id:"\u624b\u52d5\u8a08\u6642\u6301\u7e8c\u89f8\u767c\u6240\u6709\u8a08\u6642\u5668",level:2},{value:"\u76f8\u95dc\u5f71\u7247",id:"\u76f8\u95dc\u5f71\u7247",level:2}];function h(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,c.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h2,{id:"\u7c21\u4ecb",children:"\u7c21\u4ecb"}),"\n",(0,a.jsxs)(t.p,{children:["\u6e96\u78ba\u6a21\u64ec\u6642\u9593\u4f9d\u8cf4\u884c\u70ba\u5c0d\u65bc\u9a57\u8b49\u61c9\u7528\u7a0b\u5f0f\u7684\u6b63\u78ba\u6027\u81f3\u95dc\u91cd\u8981\u3002\u5229\u7528 ",(0,a.jsx)(t.a,{href:"/dotnet/docs/api/class-clock",title:"Clock",children:"Clock"})," \u529f\u80fd\u5141\u8a31\u958b\u767c\u4eba\u54e1\u5728\u6e2c\u8a66\u4e2d\u64cd\u7e31\u548c\u63a7\u5236\u6642\u9593\uff0c\u5f9e\u800c\u7cbe\u78ba\u9a57\u8b49\u6e32\u67d3\u6642\u9593\u3001\u8d85\u6642\u3001\u6392\u7a0b\u4efb\u52d9\u7b49\u529f\u80fd\uff0c\u800c\u4e0d\u6703\u6709\u5373\u6642\u57f7\u884c\u7684\u5ef6\u9072\u548c\u8b8a\u7570\u6027\u3002"]}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.a,{href:"/dotnet/docs/api/class-clock",title:"Clock",children:"Clock"})," API \u63d0\u4f9b\u4ee5\u4e0b\u65b9\u6cd5\u4f86\u63a7\u5236\u6642\u9593:"]}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"setFixedTime"}),": \u8a2d\u5b9a ",(0,a.jsx)(t.code,{children:"Date.now()"})," \u548c ",(0,a.jsx)(t.code,{children:"new Date()"})," \u7684\u56fa\u5b9a\u6642\u9593\u3002"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"install"}),": \u521d\u59cb\u5316\u6642\u9418\u4e26\u5141\u8a31\u4f60:","\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"pauseAt"}),": \u5728\u7279\u5b9a\u6642\u9593\u66ab\u505c\u6642\u9593\u3002"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"fastForward"}),": \u5feb\u9032\u6642\u9593\u3002"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"runFor"}),": \u57f7\u884c\u7279\u5b9a\u6642\u9593\u6bb5\u3002"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"resume"}),": \u6062\u5fa9\u6642\u9593\u3002"]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"setSystemTime"}),": \u8a2d\u5b9a\u7576\u524d\u7cfb\u7d71\u6642\u9593\u3002"]}),"\n"]}),"\n",(0,a.jsxs)(t.p,{children:["\u5efa\u8b70\u7684\u65b9\u6cd5\u662f\u4f7f\u7528 ",(0,a.jsx)(t.code,{children:"setFixedTime"})," \u5c07\u6642\u9593\u8a2d\u7f6e\u70ba\u7279\u5b9a\u503c\u3002\u5982\u679c\u9019\u4e0d\u9069\u7528\u65bc\u60a8\u7684\u4f7f\u7528\u6848\u4f8b\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 ",(0,a.jsx)(t.code,{children:"install"}),"\uff0c\u9019\u5141\u8a31\u60a8\u7a0d\u5f8c\u66ab\u505c\u6642\u9593\u3001\u5feb\u9032\u6642\u9593\u3001\u6ef4\u7b54\u6642\u9593\u7b49\u3002",(0,a.jsx)(t.code,{children:"setSystemTime"})," \u53ea\u5efa\u8b70\u7528\u65bc\u9ad8\u7d1a\u4f7f\u7528\u6848\u4f8b\u3002"]}),"\n",(0,a.jsx)(t.admonition,{type:"note",children:(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.a,{href:"/dotnet/docs/api/class-page#page-clock",children:"Page.Clock"})," \u8986\u84cb\u4e86\u8207\u6642\u9593\u76f8\u95dc\u7684\u5167\u5efa\u5168\u57df\u985e\u5225\u548c\u51fd\u5f0f\uff0c\u4f7f\u5b83\u5011\u53ef\u4ee5\u624b\u52d5\u63a7\u5236:   - ",(0,a.jsx)(t.code,{children:"Date"}),"   - ",(0,a.jsx)(t.code,{children:"setTimeout"}),"   - ",(0,a.jsx)(t.code,{children:"clearTimeout"}),"   - ",(0,a.jsx)(t.code,{children:"setInterval"}),"   - ",(0,a.jsx)(t.code,{children:"clearInterval"}),"   - ",(0,a.jsx)(t.code,{children:"requestAnimationFrame"}),"   - ",(0,a.jsx)(t.code,{children:"cancelAnimationFrame"}),"   - ",(0,a.jsx)(t.code,{children:"requestIdleCallback"}),"   - ",(0,a.jsx)(t.code,{children:"cancelIdleCallback"}),"   - ",(0,a.jsx)(t.code,{children:"performance"}),"   - ",(0,a.jsx)(t.code,{children:"Event.timeStamp"})]})}),"\n",(0,a.jsx)(t.h2,{id:"\u6e2c\u8a66\u9810\u5b9a\u6642\u9593",children:"\u6e2c\u8a66\u9810\u5b9a\u6642\u9593"}),"\n",(0,a.jsxs)(t.p,{children:["\u901a\u5e38\u4f60\u53ea\u9700\u8981\u507d\u9020 ",(0,a.jsx)(t.code,{children:"Date.now"})," \u540c\u6642\u4fdd\u6301\u8a08\u6642\u5668\u904b\u884c\u3002\u9019\u6a23\u6642\u9593\u6703\u81ea\u7136\u6d41\u52d5\uff0c\u4f46 ",(0,a.jsx)(t.code,{children:"Date.now"})," \u7e3d\u662f\u8fd4\u56de\u4e00\u500b\u56fa\u5b9a\u503c\u3002"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-html",children:'<div id="current-time" data-testid="current-time"></div>\n<script>\n  const renderTime = () => {\n    document.getElementById(\'current-time\').textContent =\n        new Date().toLocaleString();\n  };\n  setInterval(renderTime, 1000);\n<\/script>\n'})}),"\n",(0,a.jsx)(t.h2,{id:"\u4e00\u81f4\u7684\u6642\u9593\u548c\u8a08\u6642\u5668",children:"\u4e00\u81f4\u7684\u6642\u9593\u548c\u8a08\u6642\u5668"}),"\n",(0,a.jsxs)(t.p,{children:["\u6709\u6642\u5019\u4f60\u7684\u8a08\u6642\u5668\u4f9d\u8cf4 ",(0,a.jsx)(t.code,{children:"Date.now"}),"\uff0c\u7576 ",(0,a.jsx)(t.code,{children:"Date.now"})," \u7684\u503c\u96a8\u6642\u9593\u4e0d\u8b8a\u6642\u6703\u611f\u5230\u56f0\u60d1\u3002\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u4f60\u53ef\u4ee5\u5b89\u88dd\u6642\u9418\u4e26\u5feb\u9032\u5230\u6e2c\u8a66\u6642\u611f\u8208\u8da3\u7684\u6642\u9593\u3002"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-html",children:'<div id="current-time" data-testid="current-time"></div>\n<script>\n  const renderTime = () => {\n    document.getElementById(\'current-time\').textContent =\n        new Date().toLocaleString();\n  };\n  setInterval(renderTime, 1000);\n<\/script>\n'})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-csharp",children:'// Initialize clock with some time before the test time and let the page load naturally.\n// `Date.now` will progress as the timers fire.\nawait Page.Clock.InstallAsync(new()\n{\n  TimeDate = new DateTime(2024, 2, 2, 8, 0, 0)\n});\nawait Page.GotoAsync("http://localhost:3333");\n\n// Pretend that the user closed the laptop lid and opened it again at 10am.\n// Pause the time once reached that point.\nawait Page.Clock.PauseAtAsync(new DateTime(2024, 2, 2, 10, 0, 0));\n\n// Assert the page state.\nawait Expect(Page.GetByTestId("current-time")).ToHaveText("2/2/2024, 10:00:00 AM");\n\n// Close the laptop lid again and open it at 10:30am.\nawait Page.Clock.FastForwardAsync("30:00");\nawait Expect(Page.GetByTestId("current-time")).ToHaveText("2/2/2024, 10:30:00 AM");\n'})}),"\n",(0,a.jsx)(t.h2,{id:"\u6e2c\u8a66\u975e\u6d3b\u52d5\u76e3\u63a7",children:"\u6e2c\u8a66\u975e\u6d3b\u52d5\u76e3\u63a7"}),"\n",(0,a.jsx)(t.p,{children:"\u5728\u7db2\u9801\u61c9\u7528\u7a0b\u5f0f\u4e2d\uff0c\u4e0d\u6d3b\u52d5\u76e3\u63a7\u662f\u4e00\u500b\u5e38\u898b\u7684\u529f\u80fd\uff0c\u6703\u5728\u4e00\u6bb5\u6642\u9593\u4e0d\u6d3b\u52d5\u5f8c\u5c07\u4f7f\u7528\u8005\u767b\u51fa\u3002\u6e2c\u8a66\u9019\u500b\u529f\u80fd\u53ef\u80fd\u6703\u5f88\u68d8\u624b\uff0c\u56e0\u70ba\u4f60\u9700\u8981\u7b49\u5f85\u5f88\u9577\u6642\u9593\u624d\u80fd\u770b\u5230\u6548\u679c\u3002\u501f\u52a9\u6642\u9418\uff0c\u4f60\u53ef\u4ee5\u52a0\u901f\u6642\u9593\u4e26\u5feb\u901f\u6e2c\u8a66\u9019\u500b\u529f\u80fd\u3002"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-html",children:"<div id=\"remaining-time\" data-testid=\"remaining-time\"></div>\n<script>\n  const endTime = Date.now() + 5 * 60_000;\n  const renderTime = () => {\n    const diffInSeconds = Math.round((endTime - Date.now()) / 1000);\n    if (diffInSeconds <= 0) {\n      document.getElementById('remaining-time').textContent =\n        'You have been logged out due to inactivity.';\n    } else {\n      document.getElementById('remaining-time').textContent =\n        `You will be logged out in ${diffInSeconds} seconds.`;\n    }\n    setTimeout(renderTime, 1000);\n  };\n  renderTime();\n<\/script>\n<button type=\"button\">Interaction</button>\n"})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-csharp",children:'// Initial time does not matter for the test, so we can pick current time.\nawait Page.Clock.InstallAsync();\nawait page.GotoAsync("http://localhost:3333");\n\n// Interact with the page\nawait page.GetByRole("button").ClickAsync();\n\n// Fast forward time 5 minutes as if the user did not do anything.\n// Fast forward is like closing the laptop lid and opening it after 5 minutes.\n// All the timers due will fire once immediately, as in the real browser.\nawait Page.Clock.FastForwardAsync("05:00");\n\n// Check that the user was logged out automatically.\nawait Expect(Page.GetByText("You have been logged out due to inactivity.")).ToBeVisibleAsync();\n'})}),"\n",(0,a.jsx)(t.h2,{id:"\u624b\u52d5\u8a08\u6642\u6301\u7e8c\u89f8\u767c\u6240\u6709\u8a08\u6642\u5668",children:"\u624b\u52d5\u8a08\u6642\uff0c\u6301\u7e8c\u89f8\u767c\u6240\u6709\u8a08\u6642\u5668"}),"\n",(0,a.jsx)(t.p,{children:"\u5728\u5c11\u6578\u60c5\u6cc1\u4e0b\uff0c\u60a8\u53ef\u80fd\u5e0c\u671b\u624b\u52d5\u8abf\u6574\u6642\u9593\uff0c\u89f8\u767c\u6240\u6709\u8a08\u6642\u5668\u548c\u52d5\u756b\u5e40\uff0c\u4ee5\u5be6\u73fe\u5c0d\u6642\u9593\u6d41\u901d\u7684\u7cbe\u7d30\u63a7\u5236\u3002"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-html",children:'<div id="current-time" data-testid="current-time"></div>\n<script>\n  const renderTime = () => {\n    document.getElementById(\'current-time\').textContent =\n        new Date().toLocaleString();\n  };\n  setInterval(renderTime, 1000);\n<\/script>\n'})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-csharp",children:'// Initialize clock with a specific time, let the page load naturally.\nawait Page.Clock.InstallAsync(new()\n{\n  TimeDate = new DateTime(2024, 2, 2, 8, 0, 0, DateTimeKind.Pst)\n});\nawait page.GotoAsync("http://localhost:3333");\nvar locator = page.GetByTestId("current-time");\n\n// Pause the time flow, stop the timers, you now have manual control\n// over the page time.\nawait Page.Clock.PauseAtAsync(new DateTime(2024, 2, 2, 10, 0, 0));\nawait Expect(locator).ToHaveTextAsync("2/2/2024, 10:00:00 AM");\n\n// Tick through time manually, firing all timers in the process.\n// In this case, time will be updated in the screen 2 times.\nawait Page.Clock.RunForAsync(2000);\nawait Expect(locator).ToHaveTextAsync("2/2/2024, 10:00:02 AM");\n'})}),"\n",(0,a.jsx)(t.h2,{id:"\u76f8\u95dc\u5f71\u7247",children:"\u76f8\u95dc\u5f71\u7247"}),"\n",(0,a.jsx)(i.A,{id:"54_aC-rVKHg",title:"Playwright 1.45"})]})}function m(e={}){const{wrapper:t}={...(0,c.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},4562:(e,t,n)=>{n.d(t,{A:()=>o});var a=n(4848),c=n(6540),i=function(){return i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var c in t=arguments[n])Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c]);return e},i.apply(this,arguments)};var l=c.forwardRef((function(e,t){var n=c.useState(!1),a=n[0],l=n[1],r=c.useState(!1),o=r[0],s=r[1],d=encodeURIComponent(e.id),h="string"==typeof e.playlistCoverId?encodeURIComponent(e.playlistCoverId):null,m=e.title,p=e.poster||"hqdefault",u="&".concat(e.params)||0,g=e.muted?"&mute=1":"",x=e.announce||"Watch",w=e.webp?"webp":"jpg",j=e.webp?"vi_webp":"vi",y=e.thumbnail||(e.playlist?"https://i.ytimg.com/".concat(j,"/").concat(h,"/").concat(p,".").concat(w):"https://i.ytimg.com/".concat(j,"/").concat(d,"/").concat(p,".").concat(w)),v=e.noCookie;v=e.cookie?"https://www.youtube.com":"https://www.youtube-nocookie.com";var f=e.playlist?"".concat(v,"/embed/videoseries?autoplay=1").concat(g,"&list=").concat(d).concat(u):"".concat(v,"/embed/").concat(d,"?autoplay=1&state=1").concat(g).concat(u),k=e.activatedClass||"lyt-activated",b=e.adNetwork||!1,T=e.aspectHeight||9,C=e.aspectWidth||16,I=e.iframeClass||"",A=e.playerClass||"lty-playbtn",E=e.wrapperClass||"yt-lite",P=e.onIframeAdded||function(){},D=e.rel?"prefetch":"preload",F=e.containerElement||"article";return c.useEffect((function(){o&&P()}),[o]),c.createElement(c.Fragment,null,c.createElement("link",{rel:D,href:y,as:"image"}),c.createElement(c.Fragment,null,a&&c.createElement(c.Fragment,null,c.createElement("link",{rel:"preconnect",href:v}),c.createElement("link",{rel:"preconnect",href:"https://www.google.com"}),b&&c.createElement(c.Fragment,null,c.createElement("link",{rel:"preconnect",href:"https://static.doubleclick.net"}),c.createElement("link",{rel:"preconnect",href:"https://googleads.g.doubleclick.net"})))),c.createElement(F,{onPointerOver:function(){a||l(!0)},onClick:function(){o||s(!0)},className:"".concat(E," ").concat(o?k:""),"data-title":m,style:i({backgroundImage:"url(".concat(y,")")},{"--aspect-ratio":"".concat(T/C*100,"%")})},c.createElement("button",{type:"button",className:A,"aria-label":"".concat(x," ").concat(m)}),o&&c.createElement("iframe",{ref:t,className:I,title:m,width:"560",height:"315",frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,src:f})))}));const r="videoContainer_NvH5";const o=function({id:e,title:t,thumbnail:n}){return(0,a.jsx)("div",{className:r,children:(0,a.jsx)(l,{thumbnail:n,id:e,params:"autoplay=1&autohide=1&showinfo=0&rel=0",title:t,poster:"maxresdefault",webp:!0})})}}}]);