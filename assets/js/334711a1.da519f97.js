"use strict";(self.webpackChunkplaywright_dev=self.webpackChunkplaywright_dev||[]).push([[2518],{8962:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>m,frontMatter:()=>l,metadata:()=>o,toc:()=>d});var i=n(4848),a=n(8453),c=(n(4235),n(8328),n(3078),n(4562));const l={id:"clock",title:"\u6642\u9418"},r=void 0,o={id:"clock",title:"\u6642\u9418",description:"\u7c21\u4ecb",source:"@site/versioned_docs/version-stable/clock.mdx",sourceDirName:".",slug:"/clock",permalink:"/docs/clock",draft:!1,unlisted:!1,tags:[],version:"stable",frontMatter:{id:"clock",title:"\u6642\u9418"},sidebar:"docs",previous:{title:"Chrome \u64f4\u5145\u529f\u80fd",permalink:"/docs/chrome-extensions"},next:{title:"\u5143\u4ef6 (\u5be6\u9a57\u6027)",permalink:"/docs/test-components"}},s={},d=[{value:"\u7c21\u4ecb",id:"\u7c21\u4ecb",level:2},{value:"\u6e2c\u8a66\u9810\u5b9a\u6642\u9593",id:"\u6e2c\u8a66\u9810\u5b9a\u6642\u9593",level:2},{value:"\u4e00\u81f4\u7684\u6642\u9593\u548c\u8a08\u6642\u5668",id:"\u4e00\u81f4\u7684\u6642\u9593\u548c\u8a08\u6642\u5668",level:2},{value:"\u6e2c\u8a66\u975e\u6d3b\u52d5\u76e3\u63a7",id:"\u6e2c\u8a66\u975e\u6d3b\u52d5\u76e3\u63a7",level:2},{value:"\u624b\u52d5\u8a08\u6642\uff0c\u6301\u7e8c\u89f8\u767c\u6240\u6709\u8a08\u6642\u5668",id:"\u624b\u52d5\u8a08\u6642\u6301\u7e8c\u89f8\u767c\u6240\u6709\u8a08\u6642\u5668",level:2},{value:"\u76f8\u95dc\u5f71\u7247",id:"\u76f8\u95dc\u5f71\u7247",level:2}];function h(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h2,{id:"\u7c21\u4ecb",children:"\u7c21\u4ecb"}),"\n",(0,i.jsxs)(t.p,{children:["\u6e96\u78ba\u6a21\u64ec\u6642\u9593\u4f9d\u8cf4\u884c\u70ba\u5c0d\u65bc\u9a57\u8b49\u61c9\u7528\u7a0b\u5f0f\u7684\u6b63\u78ba\u6027\u81f3\u95dc\u91cd\u8981\u3002\u5229\u7528 ",(0,i.jsx)(t.a,{href:"/docs/api/class-clock",title:"Clock",children:"Clock"})," \u529f\u80fd\u5141\u8a31\u958b\u767c\u4eba\u54e1\u5728\u6e2c\u8a66\u4e2d\u64cd\u7e31\u548c\u63a7\u5236\u6642\u9593\uff0c\u5f9e\u800c\u7cbe\u78ba\u9a57\u8b49\u6e32\u67d3\u6642\u9593\u3001\u8d85\u6642\u3001\u6392\u7a0b\u4efb\u52d9\u7b49\u529f\u80fd\uff0c\u800c\u4e0d\u6703\u6709\u5373\u6642\u57f7\u884c\u7684\u5ef6\u9072\u548c\u8b8a\u7570\u6027\u3002"]}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.a,{href:"/docs/api/class-clock",title:"Clock",children:"Clock"})," API \u63d0\u4f9b\u4ee5\u4e0b\u65b9\u6cd5\u4f86\u63a7\u5236\u6642\u9593:"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"setFixedTime"}),": \u8a2d\u5b9a ",(0,i.jsx)(t.code,{children:"Date.now()"})," \u548c ",(0,i.jsx)(t.code,{children:"new Date()"})," \u7684\u56fa\u5b9a\u6642\u9593\u3002"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"install"}),": \u521d\u59cb\u5316\u6642\u9418\u4e26\u5141\u8a31\u4f60:","\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"pauseAt"}),": \u5728\u7279\u5b9a\u6642\u9593\u66ab\u505c\u6642\u9593\u3002"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"fastForward"}),": \u5feb\u9032\u6642\u9593\u3002"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"runFor"}),": \u57f7\u884c\u7279\u5b9a\u6642\u9593\u6bb5\u3002"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"resume"}),": \u6062\u5fa9\u6642\u9593\u3002"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"setSystemTime"}),": \u8a2d\u5b9a\u7576\u524d\u7cfb\u7d71\u6642\u9593\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["\u5efa\u8b70\u7684\u65b9\u6cd5\u662f\u4f7f\u7528 ",(0,i.jsx)(t.code,{children:"setFixedTime"})," \u5c07\u6642\u9593\u8a2d\u7f6e\u70ba\u7279\u5b9a\u503c\u3002\u5982\u679c\u9019\u4e0d\u9069\u7528\u65bc\u60a8\u7684\u4f7f\u7528\u6848\u4f8b\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 ",(0,i.jsx)(t.code,{children:"install"}),"\uff0c\u9019\u5141\u8a31\u60a8\u7a0d\u5f8c\u66ab\u505c\u6642\u9593\u3001\u5feb\u9032\u6642\u9593\u3001\u6ef4\u7b54\u6642\u9593\u7b49\u3002",(0,i.jsx)(t.code,{children:"setSystemTime"})," \u53ea\u5efa\u8b70\u7528\u65bc\u9ad8\u7d1a\u4f7f\u7528\u6848\u4f8b\u3002"]}),"\n",(0,i.jsxs)(t.admonition,{type:"note",children:[(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.a,{href:"/docs/api/class-page#page-clock",children:"Page.clock()"})," \u8986\u84cb\u4e86\u8207\u6642\u9593\u76f8\u95dc\u7684\u539f\u751f\u5168\u57df\u985e\u5225\u548c\u51fd\u5f0f\uff0c\u5141\u8a31\u624b\u52d5\u63a7\u5236\u5b83\u5011:"]}),(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"Date"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"setTimeout"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"clearTimeout"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"setInterval"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"clearInterval"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"requestAnimationFrame"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"cancelAnimationFrame"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"requestIdleCallback"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"cancelIdleCallback"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"performance"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.code,{children:"Event.timeStamp"})}),"\n"]})]}),"\n",(0,i.jsx)(t.h2,{id:"\u6e2c\u8a66\u9810\u5b9a\u6642\u9593",children:"\u6e2c\u8a66\u9810\u5b9a\u6642\u9593"}),"\n",(0,i.jsxs)(t.p,{children:["\u901a\u5e38\u4f60\u53ea\u9700\u8981\u507d\u9020 ",(0,i.jsx)(t.code,{children:"Date.now"})," \u540c\u6642\u4fdd\u6301\u8a08\u6642\u5668\u904b\u884c\u3002\u9019\u6a23\u6642\u9593\u6703\u81ea\u7136\u6d41\u52d5\uff0c\u4f46 ",(0,i.jsx)(t.code,{children:"Date.now"})," \u7e3d\u662f\u8fd4\u56de\u4e00\u500b\u56fa\u5b9a\u503c\u3002"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-html",children:'<div id="current-time" data-testid="current-time"></div>\n<script>\n  const renderTime = () => {\n    document.getElementById(\'current-time\').textContent =\n        new Date().toLocaleString();\n  };\n  setInterval(renderTime, 1000);\n<\/script>\n'})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-js",children:"await page.clock.setFixedTime(new Date('2024-02-02T10:00:00'));\nawait page.goto('http://localhost:3333');\nawait expect(page.getByTestId('current-time')).toHaveText('2/2/2024, 10:00:00 AM');\n\nawait page.clock.setFixedTime(new Date('2024-02-02T10:30:00'));\n// We know that the page has a timer that updates the time every second.\nawait expect(page.getByTestId('current-time')).toHaveText('2/2/2024, 10:30:00 AM');\n"})}),"\n",(0,i.jsx)(t.h2,{id:"\u4e00\u81f4\u7684\u6642\u9593\u548c\u8a08\u6642\u5668",children:"\u4e00\u81f4\u7684\u6642\u9593\u548c\u8a08\u6642\u5668"}),"\n",(0,i.jsxs)(t.p,{children:["\u6709\u6642\u5019\u4f60\u7684\u8a08\u6642\u5668\u4f9d\u8cf4 ",(0,i.jsx)(t.code,{children:"Date.now"}),"\uff0c\u7576 ",(0,i.jsx)(t.code,{children:"Date.now"})," \u7684\u503c\u96a8\u6642\u9593\u4e0d\u8b8a\u6642\u6703\u611f\u5230\u56f0\u60d1\u3002\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u4f60\u53ef\u4ee5\u5b89\u88dd\u6642\u9418\u4e26\u5feb\u9032\u5230\u6e2c\u8a66\u6642\u611f\u8208\u8da3\u7684\u6642\u9593\u3002"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-html",children:'<div id="current-time" data-testid="current-time"></div>\n<script>\n  const renderTime = () => {\n    document.getElementById(\'current-time\').textContent =\n        new Date().toLocaleString();\n  };\n  setInterval(renderTime, 1000);\n<\/script>\n'})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-js",children:"// Initialize clock with some time before the test time and let the page load\n// naturally. `Date.now` will progress as the timers fire.\nawait page.clock.install({ time: new Date('2024-02-02T08:00:00') });\nawait page.goto('http://localhost:3333');\n\n// Pretend that the user closed the laptop lid and opened it again at 10am,\n// Pause the time once reached that point.\nawait page.clock.pauseAt(new Date('2024-02-02T10:00:00'));\n\n// Assert the page state.\nawait expect(page.getByTestId('current-time')).toHaveText('2/2/2024, 10:00:00 AM');\n\n// Close the laptop lid again and open it at 10:30am.\nawait page.clock.fastForward('30:00');\nawait expect(page.getByTestId('current-time')).toHaveText('2/2/2024, 10:30:00 AM');\n"})}),"\n",(0,i.jsx)(t.h2,{id:"\u6e2c\u8a66\u975e\u6d3b\u52d5\u76e3\u63a7",children:"\u6e2c\u8a66\u975e\u6d3b\u52d5\u76e3\u63a7"}),"\n",(0,i.jsx)(t.p,{children:"\u5728\u7db2\u9801\u61c9\u7528\u7a0b\u5f0f\u4e2d\uff0c\u4e0d\u6d3b\u52d5\u76e3\u63a7\u662f\u4e00\u500b\u5e38\u898b\u7684\u529f\u80fd\uff0c\u6703\u5728\u4e00\u6bb5\u6642\u9593\u4e0d\u6d3b\u52d5\u5f8c\u5c07\u4f7f\u7528\u8005\u767b\u51fa\u3002\u6e2c\u8a66\u9019\u500b\u529f\u80fd\u53ef\u80fd\u6703\u5f88\u68d8\u624b\uff0c\u56e0\u70ba\u4f60\u9700\u8981\u7b49\u5f85\u5f88\u9577\u6642\u9593\u624d\u80fd\u770b\u5230\u6548\u679c\u3002\u501f\u52a9\u6642\u9418\uff0c\u4f60\u53ef\u4ee5\u52a0\u901f\u6642\u9593\u4e26\u5feb\u901f\u6e2c\u8a66\u9019\u500b\u529f\u80fd\u3002"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-html",children:"<div id=\"remaining-time\" data-testid=\"remaining-time\"></div>\n<script>\n  const endTime = Date.now() + 5 * 60_000;\n  const renderTime = () => {\n    const diffInSeconds = Math.round((endTime - Date.now()) / 1000);\n    if (diffInSeconds <= 0) {\n      document.getElementById('remaining-time').textContent =\n        'You have been logged out due to inactivity.';\n    } else {\n      document.getElementById('remaining-time').textContent =\n        `You will be logged out in ${diffInSeconds} seconds.`;\n    }\n    setTimeout(renderTime, 1000);\n  };\n  renderTime();\n<\/script>\n<button type=\"button\">Interaction</button>\n"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-js",children:"// Initial time does not matter for the test, so we can pick current time.\nawait page.clock.install();\nawait page.goto('http://localhost:3333');\n// Interact with the page\nawait page.getByRole('button').click();\n\n// Fast forward time 5 minutes as if the user did not do anything.\n// Fast forward is like closing the laptop lid and opening it after 5 minutes.\n// All the timers due will fire once immediately, as in the real browser.\nawait page.clock.fastForward('05:00');\n\n// Check that the user was logged out automatically.\nawait expect(page.getByText('You have been logged out due to inactivity.')).toBeVisible();\n"})}),"\n",(0,i.jsx)(t.h2,{id:"\u624b\u52d5\u8a08\u6642\u6301\u7e8c\u89f8\u767c\u6240\u6709\u8a08\u6642\u5668",children:"\u624b\u52d5\u8a08\u6642\uff0c\u6301\u7e8c\u89f8\u767c\u6240\u6709\u8a08\u6642\u5668"}),"\n",(0,i.jsx)(t.p,{children:"\u5728\u5c11\u6578\u60c5\u6cc1\u4e0b\uff0c\u60a8\u53ef\u80fd\u5e0c\u671b\u624b\u52d5\u8abf\u6574\u6642\u9593\uff0c\u89f8\u767c\u6240\u6709\u8a08\u6642\u5668\u548c\u52d5\u756b\u5e40\uff0c\u4ee5\u5be6\u73fe\u5c0d\u6642\u9593\u6d41\u901d\u7684\u7cbe\u7d30\u63a7\u5236\u3002"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-html",children:'<div id="current-time" data-testid="current-time"></div>\n<script>\n  const renderTime = () => {\n    document.getElementById(\'current-time\').textContent =\n        new Date().toLocaleString();\n  };\n  setInterval(renderTime, 1000);\n<\/script>\n'})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-js",children:"// Initialize clock with a specific time, let the page load naturally.\nawait page.clock.install({ time: new Date('2024-02-02T08:00:00') });\nawait page.goto('http://localhost:3333');\n\n// Pause the time flow, stop the timers, you now have manual control\n// over the page time.\nawait page.clock.pauseAt(new Date('2024-02-02T10:00:00'));\nawait expect(page.getByTestId('current-time')).toHaveText('2/2/2024, 10:00:00 AM');\n\n// Tick through time manually, firing all timers in the process.\n// In this case, time will be updated in the screen 2 times.\nawait page.clock.runFor(2000);\nawait expect(page.getByTestId('current-time')).toHaveText('2/2/2024, 10:00:02 AM');\n"})}),"\n",(0,i.jsx)(t.h2,{id:"\u76f8\u95dc\u5f71\u7247",children:"\u76f8\u95dc\u5f71\u7247"}),"\n",(0,i.jsx)(c.A,{id:"54_aC-rVKHg",title:"Playwright 1.45"})]})}function m(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},4562:(e,t,n)=>{n.d(t,{A:()=>o});var i=n(4848),a=n(6540),c=function(){return c=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},c.apply(this,arguments)};var l=a.forwardRef((function(e,t){var n=a.useState(!1),i=n[0],l=n[1],r=a.useState(!1),o=r[0],s=r[1],d=encodeURIComponent(e.id),h="string"==typeof e.playlistCoverId?encodeURIComponent(e.playlistCoverId):null,m=e.title,p=e.poster||"hqdefault",u="&".concat(e.params)||0,g=e.muted?"&mute=1":"",x=e.announce||"Watch",j=e.webp?"webp":"jpg",w=e.webp?"vi_webp":"vi",v=e.thumbnail||(e.playlist?"https://i.ytimg.com/".concat(w,"/").concat(h,"/").concat(p,".").concat(j):"https://i.ytimg.com/".concat(w,"/").concat(d,"/").concat(p,".").concat(j)),f=e.noCookie;f=e.cookie?"https://www.youtube.com":"https://www.youtube-nocookie.com";var y=e.playlist?"".concat(f,"/embed/videoseries?autoplay=1").concat(g,"&list=").concat(d).concat(u):"".concat(f,"/embed/").concat(d,"?autoplay=1&state=1").concat(g).concat(u),k=e.activatedClass||"lyt-activated",T=e.adNetwork||!1,b=e.aspectHeight||9,I=e.aspectWidth||16,C=e.iframeClass||"",D=e.playerClass||"lty-playbtn",E=e.wrapperClass||"yt-lite",F=e.onIframeAdded||function(){},A=e.rel?"prefetch":"preload",B=e.containerElement||"article";return a.useEffect((function(){o&&F()}),[o]),a.createElement(a.Fragment,null,a.createElement("link",{rel:A,href:v,as:"image"}),a.createElement(a.Fragment,null,i&&a.createElement(a.Fragment,null,a.createElement("link",{rel:"preconnect",href:f}),a.createElement("link",{rel:"preconnect",href:"https://www.google.com"}),T&&a.createElement(a.Fragment,null,a.createElement("link",{rel:"preconnect",href:"https://static.doubleclick.net"}),a.createElement("link",{rel:"preconnect",href:"https://googleads.g.doubleclick.net"})))),a.createElement(B,{onPointerOver:function(){i||l(!0)},onClick:function(){o||s(!0)},className:"".concat(E," ").concat(o?k:""),"data-title":m,style:c({backgroundImage:"url(".concat(v,")")},{"--aspect-ratio":"".concat(b/I*100,"%")})},a.createElement("button",{type:"button",className:D,"aria-label":"".concat(x," ").concat(m)}),o&&a.createElement("iframe",{ref:t,className:C,title:m,width:"560",height:"315",frameBorder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,src:y})))}));const r="videoContainer_NvH5";const o=function({id:e,title:t,thumbnail:n}){return(0,i.jsx)("div",{className:r,children:(0,i.jsx)(l,{thumbnail:n,id:e,params:"autoplay=1&autohide=1&showinfo=0&rel=0",title:t,poster:"maxresdefault",webp:!0})})}}}]);