"use strict";(self.webpackChunkplaywright_dev=self.webpackChunkplaywright_dev||[]).push([[7872],{5219:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>c,toc:()=>a});var s=n(4848),r=n(8453);n(4235),n(8328),n(3078);const i={id:"extensibility",title:"\u5ef6\u5c55\u6027"},o=void 0,c={id:"extensibility",title:"\u5ef6\u5c55\u6027",description:"\u81ea\u8a02\u9078\u64c7\u5668\u5f15\u64ce",source:"@site/versioned_docs/version-stable/extensibility.mdx",sourceDirName:".",slug:"/extensibility",permalink:"/docs/extensibility",draft:!1,unlisted:!1,tags:[],version:"stable",frontMatter:{id:"extensibility",title:"\u5ef6\u5c55\u6027"},sidebar:"docs",previous:{title:"\u4e8b\u4ef6",permalink:"/docs/events"},next:{title:"\u6846\u67b6 (Frames)",permalink:"/docs/frames"}},l={},a=[{value:"\u81ea\u8a02\u9078\u64c7\u5668\u5f15\u64ce",id:"\u81ea\u8a02\u9078\u64c7\u5668\u5f15\u64ce",level:2}];function d(e){const t={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"\u81ea\u8a02\u9078\u64c7\u5668\u5f15\u64ce",children:"\u81ea\u8a02\u9078\u64c7\u5668\u5f15\u64ce"}),"\n",(0,s.jsxs)(t.p,{children:["Playwright \u652f\u63f4\u81ea\u8a02\u9078\u64c7\u5668\u5f15\u64ce\uff0c\u5df2\u8a3b\u518a\u65bc ",(0,s.jsx)(t.a,{href:"/docs/api/class-selectors#selectors-register",children:"selectors.register()"}),"\u3002"]}),"\n",(0,s.jsx)(t.p,{children:"\u9078\u64c7\u5668\u5f15\u64ce\u61c9\u8a72\u5177\u6709\u4ee5\u4e0b\u5c6c\u6027:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"query"})," \u51fd\u5f0f\u4f86\u67e5\u8a62\u76f8\u5c0d\u65bc ",(0,s.jsx)(t.code,{children:"root"})," \u7684\u7b2c\u4e00\u500b\u7b26\u5408 ",(0,s.jsx)(t.code,{children:"selector"})," \u7684\u5143\u7d20\u3002"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"queryAll"})," \u51fd\u5f0f\u4f86\u67e5\u8a62\u76f8\u5c0d\u65bc ",(0,s.jsx)(t.code,{children:"root"})," \u7684\u6240\u6709\u7b26\u5408 ",(0,s.jsx)(t.code,{children:"selector"})," \u7684\u5143\u7d20\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["\u9810\u8a2d\u60c5\u6cc1\u4e0b\uff0c\u5f15\u64ce\u76f4\u63a5\u5728\u6846\u67b6\u7684 JavaScript \u4e0a\u4e0b\u6587\u4e2d\u57f7\u884c\uff0c\u4f8b\u5982\uff0c\u53ef\u4ee5\u547c\u53eb\u61c9\u7528\u7a0b\u5f0f\u5b9a\u7fa9\u7684\u51fd\u5f0f\u3002\u8981\u5c07\u5f15\u64ce\u8207\u6846\u67b6\u4e2d\u7684\u4efb\u4f55 JavaScript \u9694\u96e2\uff0c\u4f46\u4fdd\u7559\u5c0d DOM \u7684\u8a2a\u554f\uff0c\u8acb\u4f7f\u7528 ",(0,s.jsx)(t.code,{children:"{contentScript: true}"})," \u9078\u9805\u8a3b\u518a\u5f15\u64ce\u3002\u5167\u5bb9\u8173\u672c\u5f15\u64ce\u66f4\u5b89\u5168\uff0c\u56e0\u70ba\u5b83\u53d7\u5230\u4efb\u4f55\u5c0d\u5168\u57df\u7269\u4ef6\u7684\u7be1\u6539\u4fdd\u8b77\uff0c\u4f8b\u5982\u66f4\u6539 ",(0,s.jsx)(t.code,{children:"Node.prototype"})," \u65b9\u6cd5\u3002\u6240\u6709\u5167\u5efa\u9078\u64c7\u5668\u5f15\u64ce\u90fd\u4ee5\u5167\u5bb9\u8173\u672c\u5f62\u5f0f\u57f7\u884c\u3002\u8acb\u6ce8\u610f\uff0c\u7576\u5f15\u64ce\u8207\u5176\u4ed6\u81ea\u5b9a\u7fa9\u5f15\u64ce\u4e00\u8d77\u4f7f\u7528\u6642\uff0c\u4f5c\u70ba\u5167\u5bb9\u8173\u672c\u57f7\u884c\u4e26\u4e0d\u4fdd\u8b49\u3002"]}),"\n",(0,s.jsx)(t.p,{children:"\u5efa\u7acb\u9801\u9762\u4e4b\u524d\u5fc5\u9808\u8a3b\u518a\u9078\u64c7\u5668\u3002"}),"\n",(0,s.jsx)(t.p,{children:"\u8a3b\u518a\u9078\u64c7\u5668\u5f15\u64ce\u7684\u7bc4\u4f8b\uff0c\u8a72\u5f15\u64ce\u6839\u64da\u6a19\u7c64\u540d\u7a31\u67e5\u8a62\u5143\u7d20:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",metastring:'title="baseTest.ts"',children:"import { test as base } from '@playwright/test';\n\nexport { expect } from '@playwright/test';\n\n// Must be a function that evaluates to a selector engine instance.\nconst createTagNameEngine = () => ({\n  // Returns the first element matching given selector in the root's subtree.\n  query(root, selector) {\n    return root.querySelector(selector);\n  },\n\n  // Returns all elements matching given selector in the root's subtree.\n  queryAll(root, selector) {\n    return Array.from(root.querySelectorAll(selector));\n  }\n});\n\nexport const test = base.extend<{}, { selectorRegistration: void }>({\n  // Register selectors once per worker.\n  selectorRegistration: [async ({ playwright }, use) => {\n    // Register the engine. Selectors will be prefixed with \"tag=\".\n    await playwright.selectors.register('tag', createTagNameEngine);\n    await use();\n  }, { scope: 'worker', auto: true }],\n});\n"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",metastring:'title="example.spec.ts"',children:"import { test, expect } from './baseTest';\n\ntest('selector engine test', async ({ page }) => {\n  // Now we can use 'tag=' selectors.\n  const button = page.locator('tag=button');\n  await button.click();\n\n  // We can combine it with built-in locators.\n  await page.locator('tag=div').getByText('Click me').click();\n\n  // We can use it in any methods supporting selectors.\n  await expect(page.locator('tag=button')).toHaveCount(3);\n});\n"})})]})}function p(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);