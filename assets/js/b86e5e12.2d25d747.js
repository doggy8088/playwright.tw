"use strict";(self.webpackChunkplaywright_dev=self.webpackChunkplaywright_dev||[]).push([[9417],{5396:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>d});var r=n(4848),t=n(8453);n(4235),n(8328),n(3078);const i={id:"test-parallel",title:"\u5e73\u884c\u8655\u7406"},l=void 0,a={id:"test-parallel",title:"\u5e73\u884c\u8655\u7406",description:"\u7c21\u4ecb",source:"@site/versioned_docs/version-stable/test-parallel.mdx",sourceDirName:".",slug:"/test-parallel",permalink:"/docs/test-parallel",draft:!1,unlisted:!1,tags:[],version:"stable",frontMatter:{id:"test-parallel",title:"\u5e73\u884c\u8655\u7406"},sidebar:"docs",previous:{title:"\u5168\u57df\u8a2d\u5b9a\u548c\u62c6\u5378",permalink:"/docs/test-global-setup-teardown"},next:{title:"\u53c3\u6578\u5316\u6e2c\u8a66",permalink:"/docs/test-parameterize"}},c={},d=[{value:"\u7c21\u4ecb",id:"\u7c21\u4ecb",level:2},{value:"Worker processes",id:"worker-processes",level:2},{value:"\u9650\u5236\u5de5\u4f5c\u8005",id:"\u9650\u5236\u5de5\u4f5c\u8005",level:2},{value:"\u505c\u7528\u5e73\u884c\u8655\u7406",id:"\u505c\u7528\u5e73\u884c\u8655\u7406",level:2},{value:"\u5e73\u884c\u8655\u7406\u55ae\u500b\u6587\u4ef6\u4e2d\u7684\u6e2c\u8a66",id:"\u5e73\u884c\u8655\u7406\u55ae\u500b\u6587\u4ef6\u4e2d\u7684\u6e2c\u8a66",level:2},{value:"\u5e8f\u5217\u6a21\u5f0f",id:"\u5e8f\u5217\u6a21\u5f0f",level:2},{value:"\u5728\u591a\u53f0\u6a5f\u5668\u4e4b\u9593\u5206\u7247\u6e2c\u8a66",id:"\u5728\u591a\u53f0\u6a5f\u5668\u4e4b\u9593\u5206\u7247\u6e2c\u8a66",level:2},{value:"\u9650\u5236\u5931\u6557\u4e26\u5feb\u901f\u5931\u6557",id:"\u9650\u5236\u5931\u6557\u4e26\u5feb\u901f\u5931\u6557",level:2},{value:"Worker \u7d22\u5f15\u548c\u5e73\u884c\u7d22\u5f15",id:"worker-\u7d22\u5f15\u548c\u5e73\u884c\u7d22\u5f15",level:2},{value:"\u9694\u96e2\u5e73\u884c\u5de5\u4f5c\u8005\u4e4b\u9593\u7684\u6e2c\u8a66\u8cc7\u6599",id:"\u9694\u96e2\u5e73\u884c\u5de5\u4f5c\u8005\u4e4b\u9593\u7684\u6e2c\u8a66\u8cc7\u6599",level:3},{value:"\u63a7\u5236\u6e2c\u8a66\u9806\u5e8f",id:"\u63a7\u5236\u6e2c\u8a66\u9806\u5e8f",level:2},{value:"\u5c07\u6e2c\u8a66\u6a94\u6848\u6309\u5b57\u6bcd\u9806\u5e8f\u6392\u5e8f",id:"\u5c07\u6e2c\u8a66\u6a94\u6848\u6309\u5b57\u6bcd\u9806\u5e8f\u6392\u5e8f",level:3},{value:"\u4f7f\u7528 &quot;\u6e2c\u8a66\u6e05\u55ae&quot; \u6587\u4ef6",id:"\u4f7f\u7528-\u6e2c\u8a66\u6e05\u55ae-\u6587\u4ef6",level:3}];function o(e){const s={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.h2,{id:"\u7c21\u4ecb",children:"\u7c21\u4ecb"}),"\n",(0,r.jsxs)(s.p,{children:["Playwright Test \u5e73\u884c\u57f7\u884c\u6e2c\u8a66\u3002\u70ba\u4e86\u9054\u5230\u9019\u4e00\u9ede\uff0c\u5b83\u6703\u57f7\u884c\u591a\u500b\u540c\u6642\u904b\u884c\u7684\u5de5\u4f5c\u7a0b\u5e8f\u3002\u9810\u8a2d\u60c5\u6cc1\u4e0b\uff0c",(0,r.jsx)(s.strong,{children:"\u6e2c\u8a66\u6a94\u6848"}),"\u662f\u5e73\u884c\u57f7\u884c\u7684\u3002\u55ae\u500b\u6a94\u6848\u4e2d\u7684\u6e2c\u8a66\u6703\u6309\u9806\u5e8f\u5728\u540c\u4e00\u500b\u5de5\u4f5c\u7a0b\u5e8f\u4e2d\u57f7\u884c\u3002"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["\u4f60\u53ef\u4ee5\u4f7f\u7528 ",(0,r.jsx)(s.a,{href:"#parallelize-tests-in-a-single-file",children:(0,r.jsx)(s.code,{children:"test.describe.configure"})})," \u914d\u7f6e\u6e2c\u8a66\u4ee5\u5e73\u884c\u57f7\u884c",(0,r.jsx)(s.strong,{children:"\u55ae\u500b\u6a94\u6848\u4e2d\u7684\u6e2c\u8a66"}),"\u3002"]}),"\n",(0,r.jsxs)(s.li,{children:["\u4f60\u53ef\u4ee5\u914d\u7f6e",(0,r.jsx)(s.strong,{children:"\u6574\u500b\u5c08\u6848"}),"\uff0c\u4f7f\u7528 ",(0,r.jsx)(s.a,{href:"/docs/api/class-testproject#test-project-fully-parallel",children:"testProject.fullyParallel"})," \u6216 ",(0,r.jsx)(s.a,{href:"/docs/api/class-testconfig#test-config-fully-parallel",children:"testConfig.fullyParallel"})," \u4f7f\u6240\u6709\u6a94\u6848\u4e2d\u7684\u6240\u6709\u6e2c\u8a66\u5e73\u884c\u57f7\u884c\u3002"]}),"\n",(0,r.jsxs)(s.li,{children:["\u8981",(0,r.jsx)(s.strong,{children:"\u505c\u7528"}),"\u5e73\u884c\u8655\u7406\uff0c\u5c07 ",(0,r.jsx)(s.a,{href:"#%E5%81%9C%E7%94%A8%E5%B9%B3%E8%A1%8C%E8%99%95%E7%90%86",children:"workers \u7684\u6578\u91cf\u9650\u5236\u70ba 1"}),"\u3002"]}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["\u4f60\u53ef\u4ee5\u63a7\u5236",(0,r.jsx)(s.a,{href:"#limit-workers",children:"\u5e73\u884c\u5de5\u4f5c\u7a0b\u5e8f"}),"\u7684\u6578\u91cf\u548c",(0,r.jsx)(s.a,{href:"#limit-failures-and-fail-fast",children:"\u9650\u5236\u5931\u6557\u6b21\u6578"}),"\u4ee5\u63d0\u9ad8\u6574\u500b\u6e2c\u8a66\u5957\u4ef6\u7684\u6548\u7387\u3002"]}),"\n",(0,r.jsx)(s.h2,{id:"worker-processes",children:"Worker processes"}),"\n",(0,r.jsx)(s.p,{children:"\u6240\u6709\u6e2c\u8a66\u5728\u5de5\u4f5c\u8005\u7a0b\u5e8f\u4e2d\u57f7\u884c\u3002\u9019\u4e9b\u7a0b\u5e8f\u662f\u4f5c\u696d\u7cfb\u7d71\u7a0b\u5e8f\uff0c\u7368\u7acb\u57f7\u884c\uff0c\u7531\u6e2c\u8a66\u57f7\u884c\u5668\u5354\u8abf\u3002\u6240\u6709\u5de5\u4f5c\u8005\u6709\u76f8\u540c\u7684\u74b0\u5883\uff0c\u6bcf\u500b\u90fd\u555f\u52d5\u81ea\u5df1\u7684\u700f\u89bd\u5668\u3002"}),"\n",(0,r.jsx)(s.p,{children:"\u4f60\u7121\u6cd5\u5728\u5de5\u4f5c\u8005\u4e4b\u9593\u9032\u884c\u901a\u8a0a\u3002Playwright Test \u6703\u76e1\u53ef\u80fd\u91cd\u8907\u4f7f\u7528\u55ae\u4e00\u5de5\u4f5c\u8005\u4ee5\u52a0\u5feb\u6e2c\u8a66\u901f\u5ea6\uff0c\u56e0\u6b64\u591a\u500b\u6e2c\u8a66\u6a94\u6848\u901a\u5e38\u6703\u5728\u55ae\u4e00\u5de5\u4f5c\u8005\u4e2d\u4e00\u500b\u63a5\u4e00\u500b\u5730\u57f7\u884c\u3002"}),"\n",(0,r.jsxs)(s.p,{children:["\u5de5\u4f5c\u8005\u5728",(0,r.jsx)(s.a,{href:"/docs/test-retries#failures",children:"\u6e2c\u8a66\u5931\u6557"}),"\u5f8c\u7e3d\u662f\u6703\u95dc\u9589\uff0c\u4ee5\u4fdd\u8b49\u5f8c\u7e8c\u6e2c\u8a66\u7684\u4e7e\u6de8\u74b0\u5883\u3002"]}),"\n",(0,r.jsx)(s.h2,{id:"\u9650\u5236\u5de5\u4f5c\u8005",children:"\u9650\u5236\u5de5\u4f5c\u8005"}),"\n",(0,r.jsxs)(s.p,{children:["\u60a8\u53ef\u4ee5\u901a\u904e ",(0,r.jsx)(s.a,{href:"/docs/test-cli",children:"command line"})," \u6216\u5728 ",(0,r.jsx)(s.a,{href:"/docs/test-configuration",children:"configuration file"})," \u4e2d\u63a7\u5236\u6700\u5927\u5e73\u884c\u5de5\u4f5c\u7a0b\u5e8f\u6578\u91cf\u3002"]}),"\n",(0,r.jsx)(s.p,{children:"\u5f9e\u547d\u4ee4\u5217:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"npx playwright test --workers 4\n"})}),"\n",(0,r.jsx)(s.p,{children:"\u5728\u8a2d\u5b9a\u6a94\u4e2d:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",metastring:'title="playwright.config.ts"',children:"import { defineConfig } from '@playwright/test';\n\nexport default defineConfig({\n  // Limit the number of workers on CI, use default locally\n  workers: process.env.CI ? 2 : undefined,\n});\n"})}),"\n",(0,r.jsx)(s.h2,{id:"\u505c\u7528\u5e73\u884c\u8655\u7406",children:"\u505c\u7528\u5e73\u884c\u8655\u7406"}),"\n",(0,r.jsxs)(s.p,{children:["\u60a8\u53ef\u4ee5\u901a\u904e\u50c5\u5141\u8a31\u4e00\u6b21\u53ea\u6709\u4e00\u500b\u5de5\u4f5c\u8005\u4f86\u505c\u7528\u4efb\u4f55\u5e73\u884c\u8655\u7406\u3002\u53ef\u4ee5\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u8a2d\u7f6e ",(0,r.jsx)(s.code,{children:"workers: 1"})," \u9078\u9805\uff0c\u6216\u5728\u547d\u4ee4\u884c\u4e2d\u50b3\u905e ",(0,r.jsx)(s.code,{children:"--workers=1"}),"\u3002"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"npx playwright test --workers=1\n"})}),"\n",(0,r.jsx)(s.h2,{id:"\u5e73\u884c\u8655\u7406\u55ae\u500b\u6587\u4ef6\u4e2d\u7684\u6e2c\u8a66",children:"\u5e73\u884c\u8655\u7406\u55ae\u500b\u6587\u4ef6\u4e2d\u7684\u6e2c\u8a66"}),"\n",(0,r.jsxs)(s.p,{children:["\u9810\u8a2d\u60c5\u6cc1\u4e0b\uff0c\u55ae\u500b\u6587\u4ef6\u4e2d\u7684\u6e2c\u8a66\u6703\u6309\u9806\u5e8f\u57f7\u884c\u3002\u5982\u679c\u4f60\u5728\u55ae\u500b\u6587\u4ef6\u4e2d\u6709\u8a31\u591a\u7368\u7acb\u7684\u6e2c\u8a66\uff0c\u4f60\u53ef\u80fd\u6703\u60f3\u8981\u4f7f\u7528 ",(0,r.jsx)(s.a,{href:"/docs/api/class-test#test-describe-configure",children:"test.describe.configure()"})," \u5e73\u884c\u57f7\u884c\u5b83\u5011\u3002"]}),"\n",(0,r.jsxs)(s.p,{children:["\u8acb\u6ce8\u610f\uff0c\u5e73\u884c\u6e2c\u8a66\u5728\u4e0d\u540c\u7684\u5de5\u4f5c\u7a0b\u5e8f\u4e2d\u57f7\u884c\uff0c\u4e0d\u80fd\u5171\u4eab\u4efb\u4f55\u72c0\u614b\u6216\u5168\u57df\u8b8a\u6578\u3002\u6bcf\u500b\u6e2c\u8a66\u90fd\u53ea\u70ba\u81ea\u5df1\u57f7\u884c\u6240\u6709\u76f8\u95dc\u7684\u9264\u5b50\uff0c\u5305\u62ec ",(0,r.jsx)(s.code,{children:"beforeAll"})," \u548c ",(0,r.jsx)(s.code,{children:"afterAll"}),"\u3002"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",children:"import { test } from '@playwright/test';\n\ntest.describe.configure({ mode: 'parallel' });\n\ntest('runs in parallel 1', async ({ page }) => { /* ... */ });\ntest('runs in parallel 2', async ({ page }) => { /* ... */ });\n"})}),"\n",(0,r.jsx)(s.p,{children:"\u6216\u8005\uff0c\u60a8\u53ef\u4ee5\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u9078\u64c7\u5c07\u6240\u6709\u6e2c\u8a66\u52a0\u5165\u6b64\u5b8c\u5168\u5e73\u884c\u6a21\u5f0f:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",metastring:'title="playwright.config.ts"',children:"import { defineConfig } from '@playwright/test';\n\nexport default defineConfig({\n  fullyParallel: true,\n});\n"})}),"\n",(0,r.jsx)(s.p,{children:"\u60a8\u4e5f\u53ef\u4ee5\u9078\u64c7\u70ba\u5e7e\u500b\u5c08\u6848\u555f\u7528\u5b8c\u5168\u5e73\u884c\u6a21\u5f0f:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",metastring:'title="playwright.config.ts"',children:"import { defineConfig } from '@playwright/test';\n\nexport default defineConfig({\n  // runs all tests in all files of a specific project in parallel\n  projects: [\n    {\n      name: 'chromium',\n      use: { ...devices['Desktop Chrome'] },\n      fullyParallel: true,\n    },\n  ]\n});\n"})}),"\n",(0,r.jsx)(s.h2,{id:"\u5e8f\u5217\u6a21\u5f0f",children:"\u5e8f\u5217\u6a21\u5f0f"}),"\n",(0,r.jsx)(s.p,{children:"\u4f60\u53ef\u4ee5\u5c07\u76f8\u4e92\u4f9d\u8cf4\u7684\u6e2c\u8a66\u6a19\u8a3b\u70ba\u5e8f\u5217\u3002\u5982\u679c\u5176\u4e2d\u4e00\u500b\u5e8f\u5217\u6e2c\u8a66\u5931\u6557\uff0c\u6240\u6709\u5f8c\u7e8c\u6e2c\u8a66\u5c07\u88ab\u8df3\u904e\u3002\u4e00\u7d44\u4e2d\u7684\u6240\u6709\u6e2c\u8a66\u5c07\u4e00\u8d77\u91cd\u8a66\u3002"}),"\n",(0,r.jsx)(s.admonition,{type:"note",children:(0,r.jsx)(s.p,{children:"\u4e0d\u5efa\u8b70\u4f7f\u7528\u5e8f\u5217\u3002\u901a\u5e38\u6700\u597d\u4f7f\u60a8\u7684\u6e2c\u8a66\u7368\u7acb\uff0c\u4ee5\u4fbf\u5b83\u5011\u53ef\u4ee5\u7368\u7acb\u57f7\u884c\u3002"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",children:"import { test, type Page } from '@playwright/test';\n\n// Annotate entire file as serial.\ntest.describe.configure({ mode: 'serial' });\n\nlet page: Page;\n\ntest.beforeAll(async ({ browser }) => {\n  page = await browser.newPage();\n});\n\ntest.afterAll(async () => {\n  await page.close();\n});\n\ntest('runs first', async () => {\n  await page.goto('https://playwright.dev/');\n});\n\ntest('runs second', async () => {\n  await page.getByText('Get Started').click();\n});\n"})}),"\n",(0,r.jsx)(s.h2,{id:"\u5728\u591a\u53f0\u6a5f\u5668\u4e4b\u9593\u5206\u7247\u6e2c\u8a66",children:"\u5728\u591a\u53f0\u6a5f\u5668\u4e4b\u9593\u5206\u7247\u6e2c\u8a66"}),"\n",(0,r.jsxs)(s.p,{children:["Playwright Test \u53ef\u4ee5\u5206\u7247\u6e2c\u8a66\u5957\u4ef6\uff0c\u4ee5\u4fbf\u5728\u591a\u53f0\u6a5f\u5668\u4e0a\u57f7\u884c\u3002\u8a73\u60c5\u8acb\u53c3\u95b1",(0,r.jsx)(s.a,{href:"/docs/test-sharding",children:"\u5206\u7247\u6307\u5357"}),"\u3002"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"npx playwright test --shard=2/3\n"})}),"\n",(0,r.jsx)(s.h2,{id:"\u9650\u5236\u5931\u6557\u4e26\u5feb\u901f\u5931\u6557",children:"\u9650\u5236\u5931\u6557\u4e26\u5feb\u901f\u5931\u6557"}),"\n",(0,r.jsxs)(s.p,{children:["\u60a8\u53ef\u4ee5\u900f\u904e\u8a2d\u5b9a ",(0,r.jsx)(s.code,{children:"maxFailures"})," \u914d\u7f6e\u9078\u9805\u6216\u50b3\u905e ",(0,r.jsx)(s.code,{children:"--max-failures"})," \u547d\u4ee4\u5217\u6a19\u8a8c\u4f86\u9650\u5236\u6574\u500b\u6e2c\u8a66\u5957\u4ef6\u4e2d\u7684\u5931\u6557\u6e2c\u8a66\u6578\u91cf\u3002"]}),"\n",(0,r.jsx)(s.p,{children:'\u7576\u8a2d\u5b9a "max failures" \u6642\uff0cPlaywright Test \u6703\u5728\u9054\u5230\u6b64\u6578\u91cf\u7684\u5931\u6557\u6e2c\u8a66\u5f8c\u505c\u6b62\uff0c\u4e26\u8df3\u904e\u4efb\u4f55\u5c1a\u672a\u57f7\u884c\u7684\u6e2c\u8a66\u3002\u9019\u5c0d\u65bc\u907f\u514d\u5728\u640d\u58de\u7684\u6e2c\u8a66\u5957\u4ef6\u4e0a\u6d6a\u8cbb\u8cc7\u6e90\u975e\u5e38\u6709\u7528\u3002'}),"\n",(0,r.jsx)(s.p,{children:"\u50b3\u905e\u547d\u4ee4\u5217\u9078\u9805:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"npx playwright test --max-failures=10\n"})}),"\n",(0,r.jsx)(s.p,{children:"\u8a2d\u5b9a\u5728\u914d\u7f6e\u6a94\u6848\u4e2d:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",metastring:'title="playwright.config.ts"',children:"import { defineConfig } from '@playwright/test';\n\nexport default defineConfig({\n  // Limit the number of failures on CI to save resources\n  maxFailures: process.env.CI ? 10 : undefined,\n});\n"})}),"\n",(0,r.jsx)(s.h2,{id:"worker-\u7d22\u5f15\u548c\u5e73\u884c\u7d22\u5f15",children:"Worker \u7d22\u5f15\u548c\u5e73\u884c\u7d22\u5f15"}),"\n",(0,r.jsxs)(s.p,{children:["\u6bcf\u500b worker \u7a0b\u5e8f\u88ab\u5206\u914d\u5169\u500b id: \u5f9e 1 \u958b\u59cb\u7684\u552f\u4e00 worker \u7d22\u5f15\u548c\u4ecb\u65bc ",(0,r.jsx)(s.code,{children:"0"})," \u548c ",(0,r.jsx)(s.code,{children:"workers - 1"})," \u4e4b\u9593\u7684\u5e73\u884c\u7d22\u5f15\u3002\u7576\u4e00\u500b worker \u91cd\u65b0\u555f\u52d5\u6642\uff0c\u4f8b\u5982\u5728\u6545\u969c\u5f8c\uff0c\u65b0 worker \u7a0b\u5e8f\u5177\u6709\u76f8\u540c\u7684 ",(0,r.jsx)(s.code,{children:"parallelIndex"})," \u548c\u65b0\u7684 ",(0,r.jsx)(s.code,{children:"workerIndex"}),"\u3002"]}),"\n",(0,r.jsxs)(s.p,{children:["\u4f60\u53ef\u4ee5\u5f9e\u74b0\u5883\u8b8a\u6578 ",(0,r.jsx)(s.code,{children:"process.env.TEST_WORKER_INDEX"})," \u548c ",(0,r.jsx)(s.code,{children:"process.env.TEST_PARALLEL_INDEX"})," \u8b80\u53d6\u7d22\u5f15\uff0c\u6216\u901a\u904e ",(0,r.jsx)(s.a,{href:"/docs/api/class-testinfo#test-info-worker-index",children:"testInfo.workerIndex"})," \u548c ",(0,r.jsx)(s.a,{href:"/docs/api/class-testinfo#test-info-parallel-index",children:"testInfo.parallelIndex"})," \u8a2a\u554f\u5b83\u5011\u3002"]}),"\n",(0,r.jsx)(s.h3,{id:"\u9694\u96e2\u5e73\u884c\u5de5\u4f5c\u8005\u4e4b\u9593\u7684\u6e2c\u8a66\u8cc7\u6599",children:"\u9694\u96e2\u5e73\u884c\u5de5\u4f5c\u8005\u4e4b\u9593\u7684\u6e2c\u8a66\u8cc7\u6599"}),"\n",(0,r.jsxs)(s.p,{children:["\u4f60\u53ef\u4ee5\u5229\u7528 ",(0,r.jsx)(s.code,{children:"process.env.TEST_WORKER_INDEX"})," \u6216 ",(0,r.jsx)(s.a,{href:"/docs/api/class-testinfo#test-info-worker-index",children:"testInfo.workerIndex"})," \u63d0\u5230\u7684\u4f86\u9694\u96e2\u8cc7\u6599\u5eab\u4e2d\u4e0d\u540c\u5de5\u4f5c\u8005\u57f7\u884c\u6e2c\u8a66\u4e4b\u9593\u7684\u4f7f\u7528\u8005\u8cc7\u6599\u3002\u6240\u6709\u7531\u5de5\u4f5c\u8005\u57f7\u884c\u7684\u6e2c\u8a66\u90fd\u6703\u91cd\u8907\u4f7f\u7528\u76f8\u540c\u7684\u4f7f\u7528\u8005\u3002"]}),"\n",(0,r.jsxs)(s.p,{children:["\u5efa\u7acb ",(0,r.jsx)(s.code,{children:"playwright/fixtures.ts"})," \u6587\u4ef6\u4f86",(0,r.jsxs)(s.a,{href:"./test-fixtures#creating-a-fixture",children:["\u5efa\u7acb ",(0,r.jsx)(s.code,{children:"dbUserName"})," fixture"]})," \u4e26\u5728\u6e2c\u8a66\u8cc7\u6599\u5eab\u4e2d\u521d\u59cb\u5316\u4e00\u500b\u65b0\u4f7f\u7528\u8005\u3002\u4f7f\u7528 ",(0,r.jsx)(s.a,{href:"/docs/api/class-testinfo#test-info-worker-index",children:"testInfo.workerIndex"})," \u4f86\u5340\u5206\u4e0d\u540c\u7684\u5de5\u4f5c\u8005\u3002"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",metastring:'title="playwright/fixtures.ts"',children:"import { test as baseTest, expect } from '@playwright/test';\n// Import project utils for managing users in the test database.\nimport { createUserInTestDatabase, deleteUserFromTestDatabase } from './my-db-utils';\n\nexport * from '@playwright/test';\nexport const test = baseTest.extend<{}, { dbUserName: string }>({\n  // Returns db user name unique for the worker.\n  dbUserName: [async ({ }, use) => {\n    // Use workerIndex as a unique identifier for each worker.\n    const userName = `user-${test.info().workerIndex}`;\n    // Initialize user in the database.\n    await createUserInTestDatabase(userName);\n    await use(userName);\n    // Clean up after the tests are done.\n    await deleteUserFromTestDatabase(userName);\n  }, { scope: 'worker' }],\n});\n"})}),"\n",(0,r.jsxs)(s.p,{children:["\u73fe\u5728\uff0c\u6bcf\u500b\u6e2c\u8a66\u6587\u4ef6\u61c9\u8a72\u5f9e\u6211\u5011\u7684 fixtures \u6587\u4ef6\u4e2d\u532f\u5165 ",(0,r.jsx)(s.code,{children:"test"}),"\uff0c\u800c\u4e0d\u662f\u5f9e ",(0,r.jsx)(s.code,{children:"@playwright/test"}),"\u3002"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",metastring:'title="tests/example.spec.ts"',children:"// Important: import our fixtures.\nimport { test, expect } from '../playwright/fixtures';\n\ntest('test', async ({ dbUserName }) => {\n  // Use the user name in the test.\n});\n"})}),"\n",(0,r.jsx)(s.h2,{id:"\u63a7\u5236\u6e2c\u8a66\u9806\u5e8f",children:"\u63a7\u5236\u6e2c\u8a66\u9806\u5e8f"}),"\n",(0,r.jsxs)(s.p,{children:["Playwright Test \u6703\u4f9d\u7167\u5ba3\u544a\u7684\u9806\u5e8f\u5f9e\u55ae\u4e00\u6a94\u6848\u57f7\u884c\u6e2c\u8a66\uff0c\u9664\u975e\u4f60",(0,r.jsx)(s.a,{href:"#parallelize-tests-in-a-single-file",children:"\u5728\u55ae\u4e00\u6a94\u6848\u4e2d\u5e73\u884c\u5316\u6e2c\u8a66"}),"\u3002"]}),"\n",(0,r.jsxs)(s.p,{children:["\u6e2c\u8a66\u6a94\u6848\u7684\u57f7\u884c\u9806\u5e8f\u7121\u6cd5\u4fdd\u8b49\uff0c\u56e0\u70ba Playwright Test \u9810\u8a2d\u6703\u5e73\u884c\u57f7\u884c\u6e2c\u8a66\u6a94\u6848\u3002\u7136\u800c\uff0c\u5982\u679c\u4f60",(0,r.jsx)(s.a,{href:"#disable-parallelism",children:"\u505c\u7528\u5e73\u884c\u8655\u7406"}),"\uff0c\u4f60\u53ef\u4ee5\u901a\u904e\u6309\u5b57\u6bcd\u9806\u5e8f\u547d\u540d\u6a94\u6848\u6216\u4f7f\u7528\u201c\u6e2c\u8a66\u5217\u8868\u201d\u6a94\u6848\u4f86\u63a7\u5236\u6e2c\u8a66\u9806\u5e8f\u3002"]}),"\n",(0,r.jsx)(s.h3,{id:"\u5c07\u6e2c\u8a66\u6a94\u6848\u6309\u5b57\u6bcd\u9806\u5e8f\u6392\u5e8f",children:"\u5c07\u6e2c\u8a66\u6a94\u6848\u6309\u5b57\u6bcd\u9806\u5e8f\u6392\u5e8f"}),"\n",(0,r.jsxs)(s.p,{children:["\u7576\u4f60",(0,r.jsx)(s.strong,{children:"\u505c\u7528\u5e73\u884c\u6e2c\u8a66\u57f7\u884c"}),"\u6642\uff0cPlaywright Test \u6703\u6309\u5b57\u6bcd\u9806\u5e8f\u57f7\u884c\u6e2c\u8a66\u6a94\u6848\u3002\u4f60\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e9b\u547d\u540d\u898f\u5247\u4f86\u63a7\u5236\u6e2c\u8a66\u9806\u5e8f\uff0c\u4f8b\u5982 ",(0,r.jsx)(s.code,{children:"001-user-signin-flow.spec.ts"}),"\u3001",(0,r.jsx)(s.code,{children:"002-create-new-document.spec.ts"})," \u7b49\u7b49\u3002"]}),"\n",(0,r.jsx)(s.h3,{id:"\u4f7f\u7528-\u6e2c\u8a66\u6e05\u55ae-\u6587\u4ef6",children:'\u4f7f\u7528 "\u6e2c\u8a66\u6e05\u55ae" \u6587\u4ef6'}),"\n",(0,r.jsx)(s.admonition,{type:"warning",children:(0,r.jsx)(s.p,{children:"\u4e0d\u5efa\u8b70\u4f7f\u7528\u6e2c\u8a66\u6e05\u55ae\uff0c\u4e26\u4e14\u50c5\u63d0\u4f9b\u76e1\u529b\u800c\u70ba\u7684\u652f\u6301\u3002\u4e00\u4e9b\u529f\u80fd\u5982 VS Code \u64f4\u5145\u5957\u4ef6\u548c\u8ffd\u8e64\u53ef\u80fd\u7121\u6cd5\u8207\u6e2c\u8a66\u6e05\u55ae\u6b63\u5e38\u904b\u4f5c\u3002"})}),"\n",(0,r.jsx)(s.p,{children:"\u4f60\u53ef\u4ee5\u5c07\u4f60\u7684\u6e2c\u8a66\u653e\u5728\u591a\u500b\u6a94\u6848\u4e2d\u7684\u8f14\u52a9\u51fd\u5f0f\u4e2d\u3002\u8003\u616e\u4ee5\u4e0b\u7bc4\u4f8b\uff0c\u5176\u4e2d\u6e2c\u8a66\u4e26\u672a\u76f4\u63a5\u5b9a\u7fa9\u5728\u6a94\u6848\u4e2d\uff0c\u800c\u662f\u5728\u5305\u88dd\u51fd\u5f0f\u4e2d\u3002"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",metastring:'title="feature-a.spec.ts"',children:"import { test, expect } from '@playwright/test';\n\nexport default function createTests() {\n  test('feature-a example test', async ({ page }) => {\n    // ... test goes here\n  });\n}\n\n"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",metastring:'title="feature-b.spec.ts"',children:"import { test, expect } from '@playwright/test';\n\nexport default function createTests() {\n  test.use({ viewport: { width: 500, height: 500 } });\n\n  test('feature-b example test', async ({ page }) => {\n    // ... test goes here\n  });\n}\n"})}),"\n",(0,r.jsxs)(s.p,{children:["\u60a8\u53ef\u4ee5\u5efa\u7acb\u4e00\u500b\u6e2c\u8a66\u6e05\u55ae\u6587\u4ef6\u4f86\u63a7\u5236\u6e2c\u8a66\u7684\u9806\u5e8f - \u9996\u5148\u57f7\u884c ",(0,r.jsx)(s.code,{children:"feature-b"})," \u6e2c\u8a66\uff0c\u7136\u5f8c\u57f7\u884c ",(0,r.jsx)(s.code,{children:"feature-a"})," \u6e2c\u8a66\u3002\u6ce8\u610f\u6bcf\u500b\u6e2c\u8a66\u6587\u4ef6\u5982\u4f55\u5305\u88f9\u5728\u4e00\u500b ",(0,r.jsx)(s.code,{children:"test.describe()"})," \u5340\u584a\u4e2d\uff0c\u8a72\u5340\u584a\u547c\u53eb\u5b9a\u7fa9\u6e2c\u8a66\u7684\u51fd\u5f0f\u3002\u9019\u6a23 ",(0,r.jsx)(s.code,{children:"test.use()"})," \u547c\u53eb\u53ea\u6703\u5f71\u97ff\u55ae\u500b\u6587\u4ef6\u4e2d\u7684\u6e2c\u8a66\u3002"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",metastring:'title="test.list.ts"',children:"import { test } from '@playwright/test';\nimport featureBTests from './feature-b.spec.ts';\nimport featureATests from './feature-a.spec.ts';\n\ntest.describe(featureBTests);\ntest.describe(featureATests);\n"})}),"\n",(0,r.jsxs)(s.p,{children:["\u73fe\u5728\u901a\u904e\u5c07 workers \u8a2d\u5b9a\u70ba 1 \u4f86",(0,r.jsx)(s.strong,{children:"\u505c\u7528\u5e73\u884c\u57f7\u884c"}),"\uff0c\u4e26\u6307\u5b9a\u4f60\u7684\u6e2c\u8a66\u6e05\u55ae\u6a94\u6848\u3002"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",metastring:'title="playwright.config.ts"',children:"import { defineConfig } from '@playwright/test';\n\nexport default defineConfig({\n  workers: 1,\n  testMatch: 'test.list.ts',\n});\n"})}),"\n",(0,r.jsx)(s.admonition,{type:"note",children:(0,r.jsxs)(s.p,{children:["\u4e0d\u8981\u76f4\u63a5\u5728\u8f14\u52a9\u6a94\u6848\u4e2d\u5b9a\u7fa9\u4f60\u7684\u6e2c\u8a66\u3002\u9019\u53ef\u80fd\u6703\u5c0e\u81f4\u610f\u5916\u7d50\u679c\uff0c\u56e0\u70ba\u4f60\u7684\u6e2c\u8a66\u73fe\u5728\u4f9d\u8cf4\u65bc ",(0,r.jsx)(s.code,{children:"import"}),"/",(0,r.jsx)(s.code,{children:"require"})," \u8a9e\u53e5\u7684\u9806\u5e8f\u3002\u76f8\u53cd\uff0c\u5c07\u6e2c\u8a66\u5305\u88dd\u5728\u4e00\u500b\u51fd\u5f0f\u4e2d\uff0c\u8a72\u51fd\u5f0f\u5c07\u7531\u6e2c\u8a66\u5217\u8868\u6a94\u6848\u986f\u5f0f\u547c\u53eb\uff0c\u5982\u4e0a\u9762\u7684\u7bc4\u4f8b\u6240\u793a\u3002"]})})]})}function h(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}}}]);