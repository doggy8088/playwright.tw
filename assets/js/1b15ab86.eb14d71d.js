"use strict";(self.webpackChunkplaywright_dev=self.webpackChunkplaywright_dev||[]).push([[1739],{7900:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>c,default:()=>g,frontMatter:()=>i,metadata:()=>o,toc:()=>d});var a=t(4848),s=t(8453),l=t(4235),r=t(8328);t(3078);const i={id:"test-parameterize",title:"\u53c3\u6578\u5316\u6e2c\u8a66"},c=void 0,o={id:"test-parameterize",title:"\u53c3\u6578\u5316\u6e2c\u8a66",description:"\u7c21\u4ecb",source:"@site/versioned_docs/version-stable/test-parameterize.mdx",sourceDirName:".",slug:"/test-parameterize",permalink:"/docs/test-parameterize",draft:!1,unlisted:!1,tags:[],version:"stable",frontMatter:{id:"test-parameterize",title:"\u53c3\u6578\u5316\u6e2c\u8a66"},sidebar:"docs",previous:{title:"\u5e73\u884c\u8655\u7406",permalink:"/docs/test-parallel"},next:{title:"\u5c08\u6848",permalink:"/docs/test-projects"}},p={},d=[{value:"\u7c21\u4ecb",id:"\u7c21\u4ecb",level:2},{value:"\u53c3\u6578\u5316\u6e2c\u8a66",id:"\u53c3\u6578\u5316\u6e2c\u8a66",level:2},{value:"Before and after hooks",id:"before-and-after-hooks",level:3},{value:"\u53c3\u6578\u5316\u5c08\u6848",id:"\u53c3\u6578\u5316\u5c08\u6848",level:2},{value:"\u50b3\u905e\u74b0\u5883\u8b8a\u6578",id:"\u50b3\u905e\u74b0\u5883\u8b8a\u6578",level:2},{value:".env files",id:"env-files",level:3},{value:"\u5efa\u7acb\u6e2c\u8a66\u900f\u904e CSV \u6a94\u6848",id:"\u5efa\u7acb\u6e2c\u8a66\u900f\u904e-csv-\u6a94\u6848",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h2,{id:"\u7c21\u4ecb",children:"\u7c21\u4ecb"}),"\n",(0,a.jsx)(n.p,{children:"\u4f60\u53ef\u4ee5\u5728\u6e2c\u8a66\u5c64\u7d1a\u6216\u5c08\u6848\u5c64\u7d1a\u5c0d\u6e2c\u8a66\u9032\u884c\u53c3\u6578\u5316\u3002"}),"\n",(0,a.jsx)(n.h2,{id:"\u53c3\u6578\u5316\u6e2c\u8a66",children:"\u53c3\u6578\u5316\u6e2c\u8a66"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",metastring:'title="example.spec.ts"',children:"[\n  { name: 'Alice', expected: 'Hello, Alice!' },\n  { name: 'Bob', expected: 'Hello, Bob!' },\n  { name: 'Charlie', expected: 'Hello, Charlie!' },\n].forEach(({ name, expected }) => {\n  // You can also do it with test.describe() or with multiple tests as long the test name is unique.\n  test(`testing with ${name}`, async ({ page }) => {\n    await page.goto(`https://example.com/greet?name=${name}`);\n    await expect(page.getByRole('heading')).toHaveText(expected);\n  });\n});\n"})}),"\n",(0,a.jsx)(n.h3,{id:"before-and-after-hooks",children:"Before and after hooks"}),"\n",(0,a.jsxs)(n.p,{children:["\u5927\u591a\u6578\u60c5\u6cc1\u4e0b\uff0c\u4f60\u61c9\u8a72\u5c07 ",(0,a.jsx)(n.code,{children:"beforeEach"}),"\u3001",(0,a.jsx)(n.code,{children:"beforeAll"}),"\u3001",(0,a.jsx)(n.code,{children:"afterEach"})," \u548c ",(0,a.jsx)(n.code,{children:"afterAll"})," \u9264\u5b50\u653e\u5728 ",(0,a.jsx)(n.code,{children:"forEach"})," \u4e4b\u5916\uff0c\u9019\u6a23\u9264\u5b50\u53ea\u6703\u57f7\u884c\u4e00\u6b21:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",metastring:'title="example.spec.ts"',children:"test.beforeEach(async ({ page }) => {\n  // ...\n});\n\ntest.afterEach(async ({ page }) => {\n  // ...\n});\n\n[\n  { name: 'Alice', expected: 'Hello, Alice!' },\n  { name: 'Bob', expected: 'Hello, Bob!' },\n  { name: 'Charlie', expected: 'Hello, Charlie!' },\n].forEach(({ name, expected }) => {\n  test(`testing with ${name}`, async ({ page }) => {\n    await page.goto(`https://example.com/greet?name=${name}`);\n    await expect(page.getByRole('heading')).toHaveText(expected);\n  });\n});\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u5982\u679c\u4f60\u60f3\u70ba\u6bcf\u500b\u6e2c\u8a66\u8a2d\u7f6e\u9264\u5b50\uff0c\u4f60\u53ef\u4ee5\u5c07\u5b83\u5011\u653e\u5728 ",(0,a.jsx)(n.code,{children:"describe()"})," \u4e2d - \u9019\u6a23\u5b83\u5011\u6703\u5728\u6bcf\u6b21\u8fed\u4ee3 / \u6bcf\u500b\u55ae\u7368\u7684\u6e2c\u8a66\u4e2d\u57f7\u884c:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",metastring:'title="example.spec.ts"',children:"[\n  { name: 'Alice', expected: 'Hello, Alice!' },\n  { name: 'Bob', expected: 'Hello, Bob!' },\n  { name: 'Charlie', expected: 'Hello, Charlie!' },\n].forEach(({ name, expected }) => {\n  test.describe(() => {\n    test.beforeEach(async ({ page }) => {\n      await page.goto(`https://example.com/greet?name=${name}`);\n    });\n    test(`testing with ${expected}`, async ({ page }) => {\n      await expect(page.getByRole('heading')).toHaveText(expected);\n    });\n  });\n});\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u53c3\u6578\u5316\u5c08\u6848",children:"\u53c3\u6578\u5316\u5c08\u6848"}),"\n",(0,a.jsx)(n.p,{children:"Playwright Test \u652f\u63f4\u540c\u6642\u57f7\u884c\u591a\u500b\u6e2c\u8a66\u5c08\u6848\u3002\u5728\u4ee5\u4e0b\u7bc4\u4f8b\u4e2d\uff0c\u6211\u5011\u5c07\u4f7f\u7528\u4e0d\u540c\u7684\u9078\u9805\u57f7\u884c\u5169\u500b\u5c08\u6848\u3002"}),"\n",(0,a.jsxs)(n.p,{children:["\u6211\u5011\u5ba3\u544a\u9078\u9805 ",(0,a.jsx)(n.code,{children:"person"})," \u4e26\u5728\u914d\u7f6e\u4e2d\u8a2d\u5b9a\u503c\u3002\u7b2c\u4e00\u500b\u5c08\u6848\u4f7f\u7528\u503c ",(0,a.jsx)(n.code,{children:"Alice"}),"\uff0c\u7b2c\u4e8c\u500b\u4f7f\u7528\u503c ",(0,a.jsx)(n.code,{children:"Bob"}),"\u3002"]}),"\n",(0,a.jsxs)(l.A,{groupId:"js-flavor",defaultValue:"ts",values:[{label:"TypeScript",value:"ts"},{label:"JavaScript",value:"js"}],children:[(0,a.jsx)(r.A,{value:"ts",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",metastring:'title="my-test.ts"',children:"import { test as base } from '@playwright/test';\n\nexport type TestOptions = {\n  person: string;\n};\n\nexport const test = base.extend<TestOptions>({\n  // Define an option and provide a default value.\n  // We can later override it in the config.\n  person: ['John', { option: true }],\n});\n"})})}),(0,a.jsx)(r.A,{value:"js",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",metastring:'title="my-test.js"',children:"const base = require('@playwright/test');\n\nexports.test = base.test.extend({\n  // Define an option and provide a default value.\n  // We can later override it in the config.\n  person: ['John', { option: true }],\n});\n"})})})]}),"\n",(0,a.jsxs)(n.p,{children:["\u6211\u5011\u53ef\u4ee5\u5728\u6e2c\u8a66\u4e2d\u4f7f\u7528\u9019\u500b\u9078\u9805\uff0c\u985e\u4f3c\u65bc ",(0,a.jsx)(n.a,{href:"/docs/test-fixtures",children:"fixtures"}),"\u3002"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",metastring:'title="example.spec.ts"',children:"import { test } from './my-test';\n\ntest('test 1', async ({ page, person }) => {\n  await page.goto(`/index.html`);\n  await expect(page.locator('#node')).toContainText(person);\n  // ...\n});\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u73fe\u5728\uff0c\u6211\u5011\u53ef\u4ee5\u901a\u904e\u4f7f\u7528\u9805\u76ee\u5728\u591a\u7a2e\u914d\u7f6e\u4e2d\u57f7\u884c\u6e2c\u8a66\u3002"}),"\n",(0,a.jsxs)(l.A,{groupId:"js-flavor",defaultValue:"ts",values:[{label:"TypeScript",value:"ts"},{label:"JavaScript",value:"js"}],children:[(0,a.jsx)(r.A,{value:"ts",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",metastring:'title="playwright.config.ts"',children:"import { defineConfig } from '@playwright/test';\nimport type { TestOptions } from './my-test';\n\nexport default defineConfig<TestOptions>({\n  projects: [\n    {\n      name: 'alice',\n      use: { person: 'Alice' },\n    },\n    {\n      name: 'bob',\n      use: { person: 'Bob' },\n    },\n  ]\n});\n"})})}),(0,a.jsx)(r.A,{value:"js",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",metastring:'title="playwright.config.ts"',children:"// @ts-check\n\nmodule.exports = defineConfig({\n  projects: [\n    {\n      name: 'alice',\n      use: { person: 'Alice' },\n    },\n    {\n      name: 'bob',\n      use: { person: 'Bob' },\n    },\n  ]\n});\n"})})})]}),"\n",(0,a.jsxs)(n.p,{children:["\u6211\u5011\u4e5f\u53ef\u4ee5\u5728\u4e00\u500b\u56fa\u5b9a\u88dd\u7f6e\u4e2d\u4f7f\u7528\u8a72\u9078\u9805\u3002\u4e86\u89e3\u66f4\u591a\u95dc\u65bc",(0,a.jsx)(n.a,{href:"/docs/test-fixtures",children:"\u56fa\u5b9a\u88dd\u7f6e"}),"\u3002"]}),"\n",(0,a.jsxs)(l.A,{groupId:"js-flavor",defaultValue:"ts",values:[{label:"TypeScript",value:"ts"},{label:"JavaScript",value:"js"}],children:[(0,a.jsx)(r.A,{value:"ts",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",metastring:'title="my-test.ts"',children:"import { test as base } from '@playwright/test';\n\nexport type TestOptions = {\n  person: string;\n};\n\nexport const test = base.extend<TestOptions>({\n  // Define an option and provide a default value.\n  // We can later override it in the config.\n  person: ['John', { option: true }],\n\n  // Override default \"page\" fixture.\n  page: async ({ page, person }, use) => {\n    await page.goto('/chat');\n    // We use \"person\" parameter as a \"name\" for the chat room.\n    await page.getByLabel('User Name').fill(person);\n    await page.getByText('Enter chat room').click();\n    // Each test will get a \"page\" that already has the person name.\n    await use(page);\n  },\n});\n"})})}),(0,a.jsx)(r.A,{value:"js",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",metastring:'title="my-test.js"',children:"const base = require('@playwright/test');\n\nexports.test = base.test.extend({\n  // Define an option and provide a default value.\n  // We can later override it in the config.\n  person: ['John', { option: true }],\n\n  // Override default \"page\" fixture.\n  page: async ({ page, person }, use) => {\n    await page.goto('/chat');\n    // We use \"person\" parameter as a \"name\" for the chat room.\n    await page.getByLabel('User Name').fill(person);\n    await page.getByText('Enter chat room').click();\n    // Each test will get a \"page\" that already has the person name.\n    await use(page);\n  },\n});\n"})})})]}),"\n",(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsxs)(n.p,{children:["\u53c3\u6578\u5316\u5c08\u6848\u7684\u884c\u70ba\u5728 1.18 \u7248\u4e2d\u5df2\u66f4\u6539\u3002",(0,a.jsx)(n.a,{href:"./release-notes#breaking-change-custom-config-options",children:"\u4e86\u89e3\u66f4\u591a"}),"\u3002"]})}),"\n",(0,a.jsx)(n.h2,{id:"\u50b3\u905e\u74b0\u5883\u8b8a\u6578",children:"\u50b3\u905e\u74b0\u5883\u8b8a\u6578"}),"\n",(0,a.jsx)(n.p,{children:"\u60a8\u53ef\u4ee5\u4f7f\u7528\u74b0\u5883\u8b8a\u6578\u5f9e\u547d\u4ee4\u5217\u914d\u7f6e\u6e2c\u8a66\u3002"}),"\n",(0,a.jsx)(n.p,{children:"\u4f8b\u5982\uff0c\u8003\u616e\u4ee5\u4e0b\u9700\u8981\u7528\u6236\u540d\u548c\u5bc6\u78bc\u7684\u6e2c\u8a66\u6587\u4ef6\u3002\u901a\u5e38\u4f86\u8aaa\uff0c\u4e0d\u5c07\u4f60\u7684\u79d8\u5bc6\u5132\u5b58\u5728\u6e90\u7a0b\u5f0f\u78bc\u4e2d\u662f\u500b\u597d\u4e3b\u610f\uff0c\u6240\u4ee5\u6211\u5011\u9700\u8981\u4e00\u7a2e\u65b9\u6cd5\u5f9e\u5916\u90e8\u50b3\u905e\u79d8\u5bc6\u3002"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",metastring:'title="example.spec.ts"',children:"test(`example test`, async ({ page }) => {\n  // ...\n  await page.getByLabel('User Name').fill(process.env.USER_NAME);\n  await page.getByLabel('Password').fill(process.env.PASSWORD);\n});\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u4f60\u53ef\u4ee5\u5728\u547d\u4ee4\u5217\u4e2d\u8a2d\u5b9a\u4f60\u7684\u79d8\u5bc6\u4f7f\u7528\u8005\u540d\u7a31\u548c\u5bc6\u78bc\u4f86\u57f7\u884c\u9019\u500b\u6e2c\u8a66\u3002"}),"\n",(0,a.jsxs)(l.A,{groupId:"bash-flavor",defaultValue:"bash",values:[{label:"Bash",value:"bash"},{label:"PowerShell",value:"powershell"},{label:"Batch",value:"batch"}],children:[(0,a.jsx)(r.A,{value:"bash",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"USER_NAME=me PASSWORD=secret npx playwright test\n"})})}),(0,a.jsx)(r.A,{value:"powershell",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-powershell",children:"$env:USER_NAME=me\n$env:PASSWORD=secret\nnpx playwright test\n"})})}),(0,a.jsx)(r.A,{value:"batch",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-batch",children:"set USER_NAME=me\nset PASSWORD=secret\nnpx playwright test\n"})})})]}),"\n",(0,a.jsx)(n.p,{children:"\u540c\u6a23\u5730\uff0c\u8a2d\u5b9a\u6a94\u4e5f\u53ef\u4ee5\u8b80\u53d6\u901a\u904e\u547d\u4ee4\u5217\u50b3\u905e\u7684\u74b0\u5883\u8b8a\u6578\u3002"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",metastring:'title="playwright.config.ts"',children:"import { defineConfig } from '@playwright/test';\n\nexport default defineConfig({\n  use: {\n    baseURL: process.env.STAGING === '1' ? 'http://staging.example.test/' : 'http://example.test/',\n  }\n});\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u73fe\u5728\uff0c\u4f60\u53ef\u4ee5\u5c0d\u6e2c\u8a66\u74b0\u5883\u6216\u751f\u7522\u74b0\u5883\u57f7\u884c\u6e2c\u8a66:"}),"\n",(0,a.jsxs)(l.A,{groupId:"bash-flavor",defaultValue:"bash",values:[{label:"Bash",value:"bash"},{label:"PowerShell",value:"powershell"},{label:"Batch",value:"batch"}],children:[(0,a.jsx)(r.A,{value:"bash",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"STAGING=1 npx playwright test\n"})})}),(0,a.jsx)(r.A,{value:"powershell",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-powershell",children:"$env:STAGING=1\nnpx playwright test\n"})})}),(0,a.jsx)(r.A,{value:"batch",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-batch",children:"set STAGING=1\nnpx playwright test\n"})})})]}),"\n",(0,a.jsx)(n.h3,{id:"env-files",children:".env files"}),"\n",(0,a.jsxs)(n.p,{children:["\u70ba\u4e86\u66f4\u5bb9\u6613\u7ba1\u7406\u74b0\u5883\u8b8a\u6578\uff0c\u53ef\u4ee5\u8003\u616e\u4f7f\u7528 ",(0,a.jsx)(n.code,{children:".env"})," \u6a94\u6848\u3002\u9019\u88e1\u6709\u4e00\u500b\u7bc4\u4f8b\uff0c\u4f7f\u7528 ",(0,a.jsx)(n.a,{href:"https://www.npmjs.com/package/dotenv",children:(0,a.jsx)(n.code,{children:"dotenv"})})," \u5957\u4ef6\u76f4\u63a5\u5728\u914d\u7f6e\u6a94\u6848\u4e2d\u8b80\u53d6\u74b0\u5883\u8b8a\u6578\u3002"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",metastring:'title="playwright.config.ts"',children:"import { defineConfig } from '@playwright/test';\nimport dotenv from 'dotenv';\nimport path from 'path';\n\n// Read from \".env\" file.\ndotenv.config({ path: path.resolve(__dirname, '.env') });\n\n// Alternatively, read from \"../my.env\" file.\ndotenv.config({ path: path.resolve(__dirname, '..', 'my.env') });\n\nexport default defineConfig({\n  use: {\n    baseURL: process.env.STAGING === '1' ? 'http://staging.example.test/' : 'http://example.test/',\n  }\n});\n"})}),"\n",(0,a.jsxs)(n.p,{children:["\u73fe\u5728\uff0c\u4f60\u53ef\u4ee5\u53ea\u7de8\u8f2f ",(0,a.jsx)(n.code,{children:".env"})," \u6587\u4ef6\u4f86\u8a2d\u5b9a\u4f60\u60f3\u8981\u7684\u4efb\u4f55\u8b8a\u6578\u3002"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# .env file\nSTAGING=0\nUSER_NAME=me\nPASSWORD=secret\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u5982\u5f80\u5e38\u4e00\u6a23\u57f7\u884c\u6e2c\u8a66\uff0c\u4f60\u7684\u74b0\u5883\u8b8a\u6578\u61c9\u8a72\u6703\u88ab\u62fe\u53d6\u3002"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"npx playwright test\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u5efa\u7acb\u6e2c\u8a66\u900f\u904e-csv-\u6a94\u6848",children:"\u5efa\u7acb\u6e2c\u8a66\u900f\u904e CSV \u6a94\u6848"}),"\n",(0,a.jsx)(n.p,{children:"Playwright \u6e2c\u8a66\u57f7\u884c\u5668\u5728 Node.js \u4e2d\u57f7\u884c\uff0c\u9019\u610f\u5473\u8457\u60a8\u53ef\u4ee5\u76f4\u63a5\u5f9e\u6a94\u6848\u7cfb\u7d71\u8b80\u53d6\u6a94\u6848\u4e26\u4f7f\u7528\u60a8\u504f\u597d\u7684 CSV \u51fd\u5f0f\u5eab\u89e3\u6790\u5b83\u5011\u3002"}),"\n",(0,a.jsxs)(n.p,{children:["\u8acb\u53c3\u898b\u6b64 CSV \u6587\u4ef6\uff0c\u5728\u6211\u5011\u7684\u7bc4\u4f8b ",(0,a.jsx)(n.code,{children:"input.csv"})," \u4e2d:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-txt",children:'"test_case","some_value","some_other_value"\n"value 1","value 11","foobar1"\n"value 2","value 22","foobar21"\n"value 3","value 33","foobar321"\n"value 4","value 44","foobar4321"\n'})}),"\n",(0,a.jsxs)(n.p,{children:["\u6839\u64da\u9019\u500b\uff0c\u6211\u5011\u5c07\u4f7f\u7528\u4f86\u81ea NPM \u7684 ",(0,a.jsx)(n.a,{href:"https://www.npmjs.com/package/csv-parse",children:"csv-parse"})," \u51fd\u5f0f\u5eab\u751f\u6210\u4e00\u4e9b\u6e2c\u8a66:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-js",metastring:'title="test.spec.ts"',children:"import fs from 'fs';\nimport path from 'path';\nimport { test } from '@playwright/test';\nimport { parse } from 'csv-parse/sync';\n\nconst records = parse(fs.readFileSync(path.join(__dirname, 'input.csv')), {\n  columns: true,\n  skip_empty_lines: true\n});\n\nfor (const record of records) {\n  test(`foo: ${record.test_case}`, async ({ page }) => {\n    console.log(record.test_case, record.some_value, record.some_other_value);\n  });\n}\n"})})]})}function g(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}}}]);