"use strict";(self.webpackChunkplaywright_dev=self.webpackChunkplaywright_dev||[]).push([[7127],{9902:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>l,metadata:()=>d,toc:()=>o});var r=s(4848),n=s(8453);s(4235),s(8328),s(3078);const l={id:"test-webserver",title:"\u7db2\u9801\u4f3a\u670d\u5668"},i=void 0,d={id:"test-webserver",title:"\u7db2\u9801\u4f3a\u670d\u5668",description:"\u7c21\u4ecb",source:"@site/versioned_docs/version-stable/test-webserver.mdx",sourceDirName:".",slug:"/test-webserver",permalink:"/docs/test-webserver",draft:!1,unlisted:!1,tags:[],version:"stable",frontMatter:{id:"test-webserver",title:"\u7db2\u9801\u4f3a\u670d\u5668"},sidebar:"docs",previous:{title:"UI \u6a21\u5f0f",permalink:"/docs/test-ui-mode"},next:{title:"\u51fd\u5f0f\u5eab",permalink:"/docs/library"}},c={},o=[{value:"\u7c21\u4ecb",id:"\u7c21\u4ecb",level:2},{value:"\u8a2d\u5b9a\u4e00\u500b web \u4f3a\u670d\u5668",id:"\u8a2d\u5b9a\u4e00\u500b-web-\u4f3a\u670d\u5668",level:2},{value:"\u6dfb\u52a0\u4f3a\u670d\u5668\u8d85\u6642\u8a2d\u5b9a",id:"\u6dfb\u52a0\u4f3a\u670d\u5668\u8d85\u6642\u8a2d\u5b9a",level:2},{value:"\u6dfb\u52a0 baseURL",id:"\u6dfb\u52a0-baseurl",level:2},{value:"\u591a\u500b\u7db2\u9801\u4f3a\u670d\u5668",id:"\u591a\u500b\u7db2\u9801\u4f3a\u670d\u5668",level:2}];function a(e){const t={a:"a",code:"code",h2:"h2",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,n.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h2,{id:"\u7c21\u4ecb",children:"\u7c21\u4ecb"}),"\n",(0,r.jsxs)(t.p,{children:["Playwright \u9644\u5e36\u4e00\u500b ",(0,r.jsx)(t.code,{children:"webserver"})," \u9078\u9805\u5728\u8a2d\u5b9a\u6a94\u4e2d\uff0c\u9019\u8b93\u4f60\u80fd\u5920\u5728\u57f7\u884c\u6e2c\u8a66\u4e4b\u524d\u555f\u52d5\u672c\u5730\u958b\u767c\u4f3a\u670d\u5668\u3002\u9019\u5728\u958b\u767c\u904e\u7a0b\u4e2d\u64b0\u5beb\u6e2c\u8a66\u4ee5\u53ca\u6c92\u6709\u6e2c\u8a66\u7528\u7684\u9810\u5099\u6216\u751f\u7522 url \u6642\u975e\u5e38\u7406\u60f3\u3002"]}),"\n",(0,r.jsx)(t.h2,{id:"\u8a2d\u5b9a\u4e00\u500b-web-\u4f3a\u670d\u5668",children:"\u8a2d\u5b9a\u4e00\u500b web \u4f3a\u670d\u5668"}),"\n",(0,r.jsxs)(t.p,{children:["\u5728\u4f60\u7684 Playwright \u914d\u7f6e\u4e2d\u4f7f\u7528 ",(0,r.jsx)(t.code,{children:"webserver"})," \u5c6c\u6027\u4f86\u5728\u6e2c\u8a66\u671f\u9593\u555f\u52d5\u958b\u767c\u7db2\u9801\u4f3a\u670d\u5668\u3002"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-js",metastring:'title="playwright.config.ts"',children:"import { defineConfig } from '@playwright/test';\n\nexport default defineConfig({\n  // Run your local dev server before starting the tests\n  webServer: {\n    command: 'npm run start',\n    url: 'http://127.0.0.1:3000',\n    reuseExistingServer: !process.env.CI,\n    stdout: 'ignore',\n    stderr: 'pipe',\n  },\n});\n"})}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{style:{textAlign:"left"},children:"Property"}),(0,r.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{style:{textAlign:"left"},children:(0,r.jsx)(t.a,{href:"/docs/api/class-testconfig#test-config-web-server",children:"testConfig.webServer"})}),(0,r.jsx)(t.td,{style:{textAlign:"left"},children:"\u5728\u6e2c\u8a66\u671f\u9593\u555f\u52d5\u4e00\u500b\u958b\u767c web \u4f3a\u670d\u5668\uff08\u6216\u591a\u500b\uff09\u3002"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{style:{textAlign:"left"},children:(0,r.jsx)(t.code,{children:"command"})}),(0,r.jsx)(t.td,{style:{textAlign:"left"},children:"\u555f\u52d5\u61c9\u7528\u7a0b\u5f0f\u672c\u5730\u958b\u767c\u4f3a\u670d\u5668\u7684 Shell \u6307\u4ee4\u3002"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{style:{textAlign:"left"},children:(0,r.jsx)(t.code,{children:"url"})}),(0,r.jsx)(t.td,{style:{textAlign:"left"},children:"\u7576\u4f3a\u670d\u5668\u6e96\u5099\u63a5\u53d7\u9023\u63a5\u6642\uff0c\u9810\u671f\u8fd4\u56de 2xx\u30013xx\u3001400\u3001401\u3001402 \u6216 403 \u72c0\u614b\u78bc\u7684 http \u4f3a\u670d\u5668 URL\u3002"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{style:{textAlign:"left"},children:(0,r.jsx)(t.code,{children:"reuseExistingServer"})}),(0,r.jsxs)(t.td,{style:{textAlign:"left"},children:["\u5982\u679c\u70ba ",(0,r.jsx)(t.code,{children:"true"}),"\uff0c\u5247\u5728\u53ef\u7528\u6642\u91cd\u65b0\u4f7f\u7528\u8a72 url \u4e0a\u7684\u73fe\u6709\u4f3a\u670d\u5668\u3002\u5982\u679c\u8a72 url \u4e0a\u6c92\u6709\u4f3a\u670d\u5668\u5728\u57f7\u884c\uff0c\u5247\u6703\u57f7\u884c\u6307\u4ee4\u555f\u52d5\u65b0\u4f3a\u670d\u5668\u3002\u5982\u679c\u70ba ",(0,r.jsx)(t.code,{children:"false"}),"\uff0c\u5247\u5982\u679c\u6709\u73fe\u6709\u7a0b\u5e8f\u5728\u8a72 url \u4e0a\u76e3\u807d\uff0c\u5247\u6703\u62cb\u51fa\u932f\u8aa4\u3002\u8981\u67e5\u770b stdout\uff0c\u53ef\u4ee5\u8a2d\u7f6e ",(0,r.jsx)(t.code,{children:"DEBUG=pw:webserver"})," \u74b0\u5883\u8b8a\u6578\u3002"]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{style:{textAlign:"left"},children:(0,r.jsx)(t.code,{children:"ignoreHTTPSErrors"})}),(0,r.jsxs)(t.td,{style:{textAlign:"left"},children:["\u5728\u7372\u53d6 ",(0,r.jsx)(t.code,{children:"url"})," \u6642\u662f\u5426\u5ffd\u7565 HTTPS \u932f\u8aa4\u3002\u9810\u8a2d\u70ba ",(0,r.jsx)(t.code,{children:"false"}),"\u3002"]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{style:{textAlign:"left"},children:(0,r.jsx)(t.code,{children:"cwd"})}),(0,r.jsx)(t.td,{style:{textAlign:"left"},children:"\u555f\u52d5\u7a0b\u5e8f\u7684\u7576\u524d\u5de5\u4f5c\u76ee\u9304\uff0c\u9810\u8a2d\u70ba\u914d\u7f6e\u6587\u4ef6\u7684\u76ee\u9304\u3002"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{style:{textAlign:"left"},children:(0,r.jsx)(t.code,{children:"stdout"})}),(0,r.jsxs)(t.td,{style:{textAlign:"left"},children:["\u5982\u679c\u70ba ",(0,r.jsx)(t.code,{children:'"pipe"'}),"\uff0c\u5247\u6703\u5c07\u6307\u4ee4\u7684 stdout \u7ba1\u9053\u5230\u7a0b\u5e8f stdout\u3002\u5982\u679c\u70ba ",(0,r.jsx)(t.code,{children:'"ignore"'}),"\uff0c\u5247\u6703\u5ffd\u7565\u6307\u4ee4\u7684 stdout\u3002\u9810\u8a2d\u70ba ",(0,r.jsx)(t.code,{children:'"ignore"'}),"\u3002"]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{style:{textAlign:"left"},children:(0,r.jsx)(t.code,{children:"stderr"})}),(0,r.jsxs)(t.td,{style:{textAlign:"left"},children:["\u662f\u5426\u5c07\u6307\u4ee4\u7684 stderr \u7ba1\u9053\u5230\u7a0b\u5e8f stderr \u6216\u5ffd\u7565\u5b83\u3002\u9810\u8a2d\u70ba ",(0,r.jsx)(t.code,{children:'"pipe"'}),"\u3002"]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{style:{textAlign:"left"},children:(0,r.jsx)(t.code,{children:"timeout"})}),(0,r.jsx)(t.td,{style:{textAlign:"left"},children:"\u7b49\u5f85\u7a0b\u5e8f\u555f\u52d5\u4e26\u53ef\u7528\u7684\u6642\u9593\uff08\u4ee5\u6beb\u79d2\u70ba\u55ae\u4f4d\uff09\u3002\u9810\u8a2d\u70ba 60000\u3002"})]})]})]}),"\n",(0,r.jsx)(t.h2,{id:"\u6dfb\u52a0\u4f3a\u670d\u5668\u8d85\u6642\u8a2d\u5b9a",children:"\u6dfb\u52a0\u4f3a\u670d\u5668\u8d85\u6642\u8a2d\u5b9a"}),"\n",(0,r.jsx)(t.p,{children:"Webservers \u6709\u6642\u53ef\u80fd\u9700\u8981\u66f4\u9577\u7684\u6642\u9593\u4f86\u555f\u52d5\u3002\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u4f60\u53ef\u4ee5\u589e\u52a0\u7b49\u5f85\u4f3a\u670d\u5668\u555f\u52d5\u7684\u8d85\u6642\u6642\u9593\u3002"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-js",metastring:'title="playwright.config.ts"',children:"import { defineConfig } from '@playwright/test';\n\nexport default defineConfig({\n  // Rest of your config...\n\n  // Run your local dev server before starting the tests\n  webServer: {\n    command: 'npm run start',\n    url: 'http://127.0.0.1:3000',\n    reuseExistingServer: !process.env.CI,\n    timeout: 120 * 1000,\n  },\n});\n"})}),"\n",(0,r.jsx)(t.h2,{id:"\u6dfb\u52a0-baseurl",children:"\u6dfb\u52a0 baseURL"}),"\n",(0,r.jsxs)(t.p,{children:["\u5efa\u8b70\u5728\u914d\u7f6e\u7684 ",(0,r.jsx)(t.code,{children:"use: {}"})," \u90e8\u5206\u6307\u5b9a ",(0,r.jsx)(t.code,{children:"baseURL"}),", \u9019\u6a23\u6e2c\u8a66\u53ef\u4ee5\u4f7f\u7528\u76f8\u5c0d\u7db2\u5740, \u800c\u4e0d\u5fc5\u4e00\u904d\u53c8\u4e00\u904d\u5730\u6307\u5b9a\u5b8c\u6574\u7684 URL\u3002"]}),"\n",(0,r.jsxs)(t.p,{children:["\u7576\u4f7f\u7528 ",(0,r.jsx)(t.a,{href:"/docs/api/class-page#page-goto",children:"page.goto()"}),", ",(0,r.jsx)(t.a,{href:"/docs/api/class-page#page-route",children:"page.route()"}),", ",(0,r.jsx)(t.a,{href:"/docs/api/class-page#page-wait-for-url",children:"page.waitForURL()"}),", ",(0,r.jsx)(t.a,{href:"/docs/api/class-page#page-wait-for-request",children:"page.waitForRequest()"}),", \u6216 ",(0,r.jsx)(t.a,{href:"/docs/api/class-page#page-wait-for-response",children:"page.waitForResponse()"})," \u6642\uff0c\u5b83\u6703\u900f\u904e\u4f7f\u7528 ",(0,r.jsx)(t.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/URL/URL",children:(0,r.jsx)(t.code,{children:"URL()"})})," \u5efa\u69cb\u51fd\u5f0f\u4f86\u8003\u616e\u57fa\u790e URL \u4ee5\u5efa\u69cb\u76f8\u61c9\u7684 URL\u3002\u4f8b\u5982\uff0c\u901a\u904e\u5c07 baseURL \u8a2d\u5b9a\u70ba ",(0,r.jsx)(t.code,{children:"http://127.0.0.1:3000"})," \u4e26\u5728\u4f60\u7684\u6e2c\u8a66\u4e2d\u5c0e\u822a\u5230 ",(0,r.jsx)(t.code,{children:"/login"}),"\uff0cPlaywright \u5c07\u4f7f\u7528 ",(0,r.jsx)(t.code,{children:"http://127.0.0.1:3000/login"})," \u57f7\u884c\u6e2c\u8a66\u3002"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-js",metastring:'title="playwright.config.ts"',children:"import { defineConfig } from '@playwright/test';\n\nexport default defineConfig({\n  // Rest of your config...\n\n  // Run your local dev server before starting the tests\n  webServer: {\n    command: 'npm run start',\n    url: 'http://127.0.0.1:3000',\n    reuseExistingServer: !process.env.CI,\n  },\n  use: {\n    baseURL: 'http://127.0.0.1:3000',\n  },\n});\n"})}),"\n",(0,r.jsx)(t.p,{children:"\u73fe\u5728\u4f60\u53ef\u4ee5\u5728\u700f\u89bd\u9801\u9762\u6642\u4f7f\u7528\u76f8\u5c0d\u8def\u5f91:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-js",metastring:'title="test.spec.ts"',children:"import { test } from '@playwright/test';\n\ntest('test', async ({ page }) => {\n  // This will navigate to http://127.0.0.1:3000/login\n  await page.goto('./login');\n});\n"})}),"\n",(0,r.jsx)(t.h2,{id:"\u591a\u500b\u7db2\u9801\u4f3a\u670d\u5668",children:"\u591a\u500b\u7db2\u9801\u4f3a\u670d\u5668"}),"\n",(0,r.jsxs)(t.p,{children:["\u591a\u500b\u7db2\u9801\u4f3a\u670d\u5668 (\u6216\u80cc\u666f\u7a0b\u5e8f) \u53ef\u4ee5\u901a\u904e\u63d0\u4f9b ",(0,r.jsx)(t.code,{children:"webServer"})," \u914d\u7f6e\u9663\u5217\u540c\u6642\u555f\u52d5\u3002\u67e5\u770b ",(0,r.jsx)(t.a,{href:"/docs/api/class-testconfig#test-config-web-server",children:"testConfig.webServer"})," \u4ee5\u7372\u53d6\u66f4\u591a\u8cc7\u8a0a\u3002"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-js",metastring:'title="playwright.config.ts"',children:"import { defineConfig } from '@playwright/test';\n\nexport default defineConfig({\n  webServer: [\n    {\n      command: 'npm run start',\n      url: 'http://127.0.0.1:3000',\n      timeout: 120 * 1000,\n      reuseExistingServer: !process.env.CI,\n    },\n    {\n      command: 'npm run backend',\n      url: 'http://127.0.0.1:3333',\n      timeout: 120 * 1000,\n      reuseExistingServer: !process.env.CI,\n    }\n  ],\n  use: {\n    baseURL: 'http://127.0.0.1:3000',\n  },\n});\n"})})]})}function h(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);